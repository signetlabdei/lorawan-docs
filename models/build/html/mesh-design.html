
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>21.1. Design Documentation &#8212; Model Library</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/default.css?v=bb97339c" />
    <script src="_static/documentation_options.js?v=316584e3"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="21.2. User Documentation" href="mesh-user.html" />
    <link rel="prev" title="21. Wi-Fi Mesh Module Documentation" href="mesh.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico"
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>


  </head><body>
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" width="100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo">
              <a id="ns3_home1"
                 href="http://www.nsnam.org/">
                 <img alt="ns-3 Logo" style="background-color: unset;"
                      src="_static/ns-3-inverted-notext-small.png"/>
              </a>
            </td>
            <td id="projecttext">
              <div id="projectbrief">A Discrete-Event Network Simulator</div>
              <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
            </td>

            <td id="ns3-menu">
              <div class="menu">
                <ul >
                  <li style="background-image:none">
                    <a id="ns3_home2"
                         href="http://www.nsnam.org/"
                         >&nbsp;&nbsp;Home</a>
                  </li>
                  <li><span
                        onmouseover="mopen('mTuts')"
                        onmouseout="mclosetime()"
                          >Tutorials &nbsp;&#x25BC;</span>
                      <div id="mTuts"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_tut"
                           href="/docs/tutorial/html/index.html"
                            >English</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDocs')"
                        onmouseout="mclosetime()"
                          >Documentation &nbsp;&#x25BC;</span>
                      <div id="mDocs"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_ins"
                           href="/docs/installation/html/index.html"
                           >Installation</a><br/>
                        <a id="ns3_man"
                           href="/docs/manual/html/index.html"
                           >Manual</a><br/>
                        <a id="ns3_mod"
                           href="/docs/models/html/index.html"
                           >Models</a><br/>
                        <a id="ns3_con"
                           href="/docs/contributing/html/index.html"
                           >Contributing</a><br/>
                        <a id="ns3_wiki"
                           href="http://www.nsnam.org/wiki"
                           >Wiki</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDev')"
                        onmouseout="mclosetime()"
                          >Development &nbsp;&#x25BC;</span>
                      <div id="mDev"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_api"
                           href="/docs/doxygen/html/index.html"
                           >API Docs</a><br/>
                        <a id="ns3_bugs"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/issues"
                           >Issue Tracker</a><br/>
                        <a id="ns3_merge"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests"
                           >Merge Requests</a><br/>
                      </div>
                  </li>
                </ul>
              </div>
            </td>

            <td id="projectsection">
              <span style="margin-right:10px">Models</span>
            </td>
          </tr>
        </tbody>
      </table>
      <script  type="text/javascript">ns3_write_links()</script>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mesh-user.html" title="21.2. User Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mesh.html" title="21. Wi-Fi Mesh Module Documentation"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="mesh.html" accesskey="U"><span class="section-number">21. </span>Wi-Fi Mesh Module Documentation</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">21.1. </span>Design Documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="design-documentation">
<h1><span class="section-number">21.1. </span>Design Documentation<a class="headerlink" href="#design-documentation" title="Link to this heading">¶</a></h1>
<section id="overview">
<h2><span class="section-number">21.1.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The <em>ns-3</em> <cite>mesh</cite> module extends the <em>ns-3</em> <cite>wifi</cite> module to provide mesh
networking capabilities according to the IEEE 802.11s standard <a class="reference internal" href="mesh-references.html#ieee80211s" id="id1"><span>[ieee80211s]</span></a>.</p>
<p>The basic purpose of IEEE 802.11s is to define a mode of operation for
Wi-Fi that permits frames to be forwarded over multiple radio hops
transparent to higher layer protocols such as IP.  To accomplish this,
mesh-capable stations form a <cite>Mesh Basic Service Set</cite> (MBSS) by running
a pair-wise peering protocol to establish forwarding associations, and
by running a routing protocol to find paths through the network.  A
special gateway device called a <cite>mesh gate</cite> allows a MBSS to interconnect
with a Distribution System (DS).</p>
<p>The basic enhancements defined by IEEE 802.11s include:</p>
<ul class="simple">
<li><p>discovery services</p></li>
<li><p>peering management</p></li>
<li><p>security</p></li>
<li><p>beaconing and synchronization</p></li>
<li><p>the Mesh Coordination Function (MCF)</p></li>
<li><p>power management</p></li>
<li><p>channel switching</p></li>
<li><p>extended frame formats</p></li>
<li><p>path selection and forwarding</p></li>
<li><p>interworking (proxy mesh gateways)</p></li>
<li><p>intra-mesh congestion control, and</p></li>
<li><p>emergency service support.</p></li>
</ul>
<p>The <em>ns-3</em> models implement only a subset of the above service extensions,
focusing mainly on those items related to peering and routing/forwarding
of data frames through the mesh.</p>
<p>The Mesh NetDevice based on 802.11s D3.0 draft standard
was added in <em>ns-3.6</em> and includes the Mesh Peering Management Protocol and
HWMP (routing) protocol implementations. An overview
presentation by Kirill Andreev was published at the Workshop on ns-3
in 2009 <a class="reference internal" href="mesh-references.html#and09" id="id2"><span>[And09]</span></a>.  An overview paper is available at <a class="reference internal" href="mesh-references.html#and10" id="id3"><span>[And10]</span></a>.</p>
<p>As of ns-3.23 release, the model has been updated to the 802.11s-2012
standard <a class="reference internal" href="mesh-references.html#ieee80211s" id="id4"><span>[ieee80211s]</span></a> with regard to packet formats, based on the
contribution in <a class="reference internal" href="mesh-references.html#hep15" id="id5"><span>[Hep15]</span></a>.</p>
<p>These changes include:</p>
<ul class="simple">
<li><p>Category codes and the categories compliant to IEEE-802.11-2012 Table 8-38—Category values.</p></li>
<li><p>Information Elements (An adjustment of the element ID values was needed according to Table 8-54 of IEEE-802.11-2012).</p></li>
<li><p>Mesh Peering Management element format changed according to IEEE-802.11-2012 Figure 8-370.</p></li>
<li><p>Mesh Configuration element format changed according to IEEE-802.11-2012 Figure 8-363.</p></li>
<li><p>PERR element format changed according to IEEE-802.11-2012 Figure 8-394.</p></li>
</ul>
<p>With these changes the messages of the Peering Management Protocol and Hybrid Wireless Mesh Protocol will be transmitted compliant to IEEE802.11-2012 and the resulting pcap trace files can be analyzed by Wireshark.</p>
<p>The multi-interface mesh points are supported as an extension of IEEE draft version 3.0. Note that corresponding <em>ns-3</em> mesh device helper creates a single interface station by default.</p>
<section id="overview-of-ieee-802-11s">
<h3><span class="section-number">21.1.1.1. </span>Overview of IEEE 802.11s<a class="headerlink" href="#overview-of-ieee-802-11s" title="Link to this heading">¶</a></h3>
<p>The implementation of the 802.11s extension consists of two main parts: the Peer Management Protocol (PMP) and Hybrid Wireless Mesh Protocol (HWMP).</p>
<p>The tasks of the peer management protocol are the following:</p>
<ul class="simple">
<li><p>opening links, detecting beacons, and starting peer link finite state machine, and</p></li>
<li><p>closing peer links due to transmission failures or beacon loss.</p></li>
</ul>
<p>If a peer link between the sender and receiver does not exist, a frame will be
dropped. So, the plug-in to the peer management protocol (PMP) is the first
in the list of <code class="docutils literal notranslate"><span class="pre">ns3::MeshWifiInterfaceMacPlugins</span></code> to be used.</p>
<section id="peer-management-protocol">
<h4><span class="section-number">21.1.1.1.1. </span>Peer management protocol<a class="headerlink" href="#peer-management-protocol" title="Link to this heading">¶</a></h4>
<p>The peer management protocol consists of three main parts:</p>
<ul class="simple">
<li><p>the protocol itself, <code class="docutils literal notranslate"><span class="pre">ns3::dot11s::PeerManagementProtocol</span></code>, which keeps all active peer links on interfaces, handles all changes of their states and notifies the routing protocol about link failures.</p></li>
<li><p>the MAC plug-in, <code class="docutils literal notranslate"><span class="pre">ns3::dot11s::PeerManagementProtocolMac</span></code>, which drops frames if there is no peer link, and peeks all needed information from management frames and information elements from beacons.</p></li>
<li><p>the peer link, <code class="docutils literal notranslate"><span class="pre">ns3::dot11s::PeerLink</span></code>, which keeps finite state machine of each peer link, keeps beacon loss counter and counter of successive transmission failures.</p></li>
</ul>
<p>The procedure of closing a peer link is not described in detail in the
standard, so in the model the link may be closed by:</p>
<ul class="simple">
<li><p>beacon loss (see an appropriate attribute of ns3::dot11s::PeerLink class)</p></li>
<li><p>transmission failure – when a predefined number of successive packets have failed to transmit, the link will be closed.</p></li>
</ul>
<p>The peer management protocol is also responsible for beacon collision avoidance, because it keeps beacon timing elements from all neighbours. Note that the PeerManagementProtocol is not attached to the MeshPointDevice as a routing protocol, but the structure is similar: the upper tier of the protocol is
<code class="docutils literal notranslate"><span class="pre">ns3::dot11s::PeerManagementProtocol</span></code> and its plug-in is
<code class="docutils literal notranslate"><span class="pre">ns3::dot11s::PeerManagementProtocolMac</span></code>.</p>
</section>
<section id="hybrid-wireless-mesh-protocol">
<h4><span class="section-number">21.1.1.1.2. </span>Hybrid Wireless Mesh Protocol<a class="headerlink" href="#hybrid-wireless-mesh-protocol" title="Link to this heading">¶</a></h4>
<p>HWMP is implemented in both modes, reactive and proactive, although path maintenance is not implemented (so active routes may time out and need to be rebuilt, causing packet loss). Also the model implements an ability to transmit broadcast data and management frames as unicasts (see appropriate attributes). This feature is disabled at a station when the number of neighbors of the station is more than a threshold value.</p>
</section>
<section id="forwarding-delay">
<h4><span class="section-number">21.1.1.1.3. </span>Forwarding delay<a class="headerlink" href="#forwarding-delay" title="Link to this heading">¶</a></h4>
<p>Previous versions of this model have had issues with collisions due to
the lack of a model for forwarding delay, and lack of clarity about whether
backoff should be invoked when forwarding a broadcast frame.  These issues
become problematic for mesh, because in a topology in which multiple nodes
within radio range of the next hop node decide to forward a received
frame at the same time, they will repeatedly collide (if no backoff is
triggered).  Past contributors have argued for the triggering of backoff
when forwarding a frame (e.g., <a class="reference internal" href="mesh-references.html#hep16" id="id6"><span>[Hep16]</span></a>), but current wifi module maintainers
concluded that the standard does not call for backoff in this case.
This was also privately confirmed with a Wi-Fi vendor.
<a class="reference external" href="https://gitlab.com/nsnam/ns-3-dev/-/issues/478">Issue 478</a> in the GitLab.com
tracker has more discussion on this point.</p>
<p>In practice, it is assumed that collisions can be avoided due to the fact
that each mesh node will take slightly different times to process and
forward the frame, and one will go first and trigger a channel busy detection
on the other nodes.  To accomplish this in ns-3, we
must include a model for forwarding delay that includes some randomness.</p>
<p>The class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::MeshPointDevice</span></code> is responsible for forwarding
unicast frames, and the class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::dot11s::HwmpProtocol</span></code> is
responsible for forwarding management frames when HWMP is used.
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::MeshPointDevice</span></code> has an attribute
called <cite>ForwardingDelay</cite> that configures a random variable (units of
microseconds) from which a forwarding delay value is drawn for each frame
forwarding event.  The default configuration of this attribute
is a uniform random variable between 300 and 400 microseconds.  The mean
value was chosen based on the measurement results reported in <a class="reference internal" href="mesh-references.html#hep16" id="id7"><span>[Hep16]</span></a> which
measured and derived an average 350 microsecond delay in forwarding frames
on real mesh devices.  The range of this variable is somewhat arbitrary and
determined by some simulation testing to provide a generally low
probability of collision; the 100 microsecond range is roughly 11 slot times.
The HWMP protocol can also access this random variable to create forwarding
delay for the forwarding of management frames.
Users may substitute other random variable configurations as desired.</p>
</section>
</section>
</section>
<section id="scope-and-limitations">
<h2><span class="section-number">21.1.2. </span>Scope and Limitations<a class="headerlink" href="#scope-and-limitations" title="Link to this heading">¶</a></h2>
<section id="supported-features">
<h3><span class="section-number">21.1.2.1. </span>Supported features<a class="headerlink" href="#supported-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Peering Management Protocol (PMP), including link close heuristics and beacon collision avoidance.</p></li>
<li><p>Hybrid Wireless Mesh Protocol (HWMP), including proactive and reactive modes, unicast/broadcast propagation of management traffic, multi-radio extensions.</p></li>
<li><p>802.11e compatible airtime link metric.</p></li>
</ul>
</section>
<section id="verification">
<h3><span class="section-number">21.1.2.2. </span>Verification<a class="headerlink" href="#verification" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Comes with the custom Wireshark dissector.</p></li>
<li><p>Linux kernel mac80211 layer compatible message formats.</p></li>
</ul>
</section>
<section id="unsupported-features">
<h3><span class="section-number">21.1.2.3. </span>Unsupported features<a class="headerlink" href="#unsupported-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Mesh Coordinated Channel Access (MCCA).</p></li>
<li><p>Internetworking: mesh access point and mesh portal.</p></li>
<li><p>Security.</p></li>
<li><p>Power save.</p></li>
<li><p>Path maintenance (sending PREQ proactively before a path expires)</p></li>
<li><p>Though multi-radio operation is supported, no channel assignment protocol is proposed for now. (Correct channel switching is not implemented)</p></li>
</ul>
</section>
<section id="models-yet-to-be-created">
<h3><span class="section-number">21.1.2.4. </span>Models yet to be created<a class="headerlink" href="#models-yet-to-be-created" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Mesh access point (QoS + non-QoS?)</p></li>
<li><p>Mesh portal (QoS + non-QoS?)</p></li>
</ul>
</section>
<section id="open-issues">
<h3><span class="section-number">21.1.2.5. </span>Open issues<a class="headerlink" href="#open-issues" title="Link to this heading">¶</a></h3>
<p>Users should be aware that the mesh module has not been actively maintained
for several years and that there may be some performance and
standards-alignment issues with the current code.  Below is a listing of
possible (confirmed and unconfirmed) issues.</p>
<p>A bug was previously reported in the Wi-Fi module that manifests itself as performance
degradation in large mesh networks, due to incorrect duplicate frame
detection for QoS data frames (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2326">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2326</a>).</p>
<p>Mesh does not work for 802.11n/ac/ax stations (<a class="reference external" href="https://gitlab.com/nsnam/ns-3-dev/-/issues/176">https://gitlab.com/nsnam/ns-3-dev/-/issues/176</a>).</p>
<p>Mesh PCAP is not decoded properly by Wireshark (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2880">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2880</a>).</p>
<p>Energy module can not be used on mesh devices (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2265">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2265</a>).</p>
<p>IE11S_MESH_PEERING_PROTOCOL_VERSION should be removed as per standard.
Protocol ID should actually be part of the Mesh Peering Management IE (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2600">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2600</a>).</p>
<p>MeshInformationElementVector printing error (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2728">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2728</a>).</p>
<p>Mesh is not compatible with IPv6 (<a class="reference external" href="https://www.nsnam.org/bugzilla/show_bug.cgi?id=2881">https://www.nsnam.org/bugzilla/show_bug.cgi?id=2881</a>).</p>
<p>Mesh is forwarding multicast frames as unicast rather than as group-addressed frames (<a class="reference external" href="https://gitlab.com/nsnam/ns-3-dev/-/issues/485">https://gitlab.com/nsnam/ns-3-dev/-/issues/485</a>).</p>
<p>Mesh group addresses are not being set correctly for multicast frames (<a class="reference external" href="https://gitlab.com/nsnam/ns-3-dev/-/issues/476">https://gitlab.com/nsnam/ns-3-dev/-/issues/476</a>).</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">21.1. Design Documentation</a><ul>
<li><a class="reference internal" href="#overview">21.1.1. Overview</a><ul>
<li><a class="reference internal" href="#overview-of-ieee-802-11s">21.1.1.1. Overview of IEEE 802.11s</a><ul>
<li><a class="reference internal" href="#peer-management-protocol">21.1.1.1.1. Peer management protocol</a></li>
<li><a class="reference internal" href="#hybrid-wireless-mesh-protocol">21.1.1.1.2. Hybrid Wireless Mesh Protocol</a></li>
<li><a class="reference internal" href="#forwarding-delay">21.1.1.1.3. Forwarding delay</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#scope-and-limitations">21.1.2. Scope and Limitations</a><ul>
<li><a class="reference internal" href="#supported-features">21.1.2.1. Supported features</a></li>
<li><a class="reference internal" href="#verification">21.1.2.2. Verification</a></li>
<li><a class="reference internal" href="#unsupported-features">21.1.2.3. Unsupported features</a></li>
<li><a class="reference internal" href="#models-yet-to-be-created">21.1.2.4. Models yet to be created</a></li>
<li><a class="reference internal" href="#open-issues">21.1.2.5. Open issues</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="mesh.html"
                          title="previous chapter"><span class="section-number">21. </span>Wi-Fi Mesh Module Documentation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="mesh-user.html"
                          title="next chapter"><span class="section-number">21.2. </span>User Documentation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mesh-design.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mesh-user.html" title="21.2. User Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="mesh.html" title="21. Wi-Fi Mesh Module Documentation"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="mesh.html" ><span class="section-number">21. </span>Wi-Fi Mesh Module Documentation</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">21.1. </span>Design Documentation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2006-2019.
      Last updated on Nov 10, 2023 15:56.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>