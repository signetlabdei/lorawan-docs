
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>16.2. IPv4 &#8212; Model Library</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/default.css?v=bb97339c" />
    <script src="_static/documentation_options.js?v=951d00fa"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="16.3. IPv6" href="ipv6.html" />
    <link rel="prev" title="16.1. Internet Stack" href="internet-stack.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico"
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>


  </head><body>
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" width="100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo">
              <a id="ns3_home1"
                 href="http://www.nsnam.org/">
                 <img alt="ns-3 Logo" style="background-color: unset;"
                      src="_static/ns-3-inverted-notext-small.png"/>
              </a>
            </td>
            <td id="projecttext">
              <div id="projectbrief">A Discrete-Event Network Simulator</div>
              <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
            </td>

            <td id="ns3-menu">
              <div class="menu">
                <ul >
                  <li style="background-image:none">
                    <a id="ns3_home2"
                         href="http://www.nsnam.org/"
                         >&nbsp;&nbsp;Home</a>
                  </li>
                  <li><span
                        onmouseover="mopen('mTuts')"
                        onmouseout="mclosetime()"
                          >Tutorials &nbsp;&#x25BC;</span>
                      <div id="mTuts"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_tut"
                           href="/docs/tutorial/html/index.html"
                            >English</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDocs')"
                        onmouseout="mclosetime()"
                          >Documentation &nbsp;&#x25BC;</span>
                      <div id="mDocs"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_ins"
                           href="/docs/installation/html/index.html"
                           >Installation</a><br/>
                        <a id="ns3_man"
                           href="/docs/manual/html/index.html"
                           >Manual</a><br/>
                        <a id="ns3_mod"
                           href="/docs/models/html/index.html"
                           >Models</a><br/>
                        <a id="ns3_con"
                           href="/docs/contributing/html/index.html"
                           >Contributing</a><br/>
                        <a id="ns3_wiki"
                           href="http://www.nsnam.org/wiki"
                           >Wiki</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDev')"
                        onmouseout="mclosetime()"
                          >Development &nbsp;&#x25BC;</span>
                      <div id="mDev"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_api"
                           href="/docs/doxygen/html/index.html"
                           >API Docs</a><br/>
                        <a id="ns3_bugs"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/issues"
                           >Issue Tracker</a><br/>
                        <a id="ns3_merge"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests"
                           >Merge Requests</a><br/>
                      </div>
                  </li>
                </ul>
              </div>
            </td>

            <td id="projectsection">
              <span style="margin-right:10px">Models</span>
            </td>
          </tr>
        </tbody>
      </table>
      <script  type="text/javascript">ns3_write_links()</script>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ipv6.html" title="16.3. IPv6"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="internet-stack.html" title="16.1. Internet Stack"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="internet-models.html" accesskey="U"><span class="section-number">16. </span>Internet Models (IP, TCP, Routing, UDP)</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">16.2. </span>IPv4</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ipv4">
<h1><span class="section-number">16.2. </span>IPv4<a class="headerlink" href="#ipv4" title="Link to this heading">¶</a></h1>
<p>This chapter describes the <em>ns-3</em> IPv4 address assignment and basic components tracking.</p>
<section id="ipv4-addresses-assignment">
<h2><span class="section-number">16.2.1. </span>IPv4 addresses assignment<a class="headerlink" href="#ipv4-addresses-assignment" title="Link to this heading">¶</a></h2>
<p>In order to use IPv4 on a network, the first thing to do is assigning IPv4 addresses.</p>
<p>Any IPv4-enabled <em>ns-3</em> node will have at least one NetDevice: the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::LoopbackNetDevice</span></code>.
The loopback device address is <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>.
All the other NetDevices will have one (or more) IPv4 addresses.</p>
<p>Note that, as today, <em>ns-3</em> does not have a NAT module, and it does not follows the rules about
filtering private addresses (<span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc1918.html"><strong>RFC 1918</strong></a>): 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16.
These addresses are routed as any other address. This behaviour could change in the future.</p>
<p>IPv4 global addresses can be:</p>
<ul class="simple">
<li><p>manually assigned</p></li>
<li><p>assigned though DHCP</p></li>
</ul>
<p><em>ns-3</em> can use both methods, and it’s quite important to understand the implications of both.</p>
<section id="manually-assigned-ipv4-addresses">
<h3><span class="section-number">16.2.1.1. </span>Manually assigned IPv4 addresses<a class="headerlink" href="#manually-assigned-ipv4-addresses" title="Link to this heading">¶</a></h3>
<p>This is probably the easiest and most used method. As an example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">n0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">NodeContainer</span><span class="w"> </span><span class="nf">net</span><span class="p">(</span><span class="n">n0</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">);</span>
<span class="n">CsmaHelper</span><span class="w"> </span><span class="n">csma</span><span class="p">;</span>
<span class="n">NetDeviceContainer</span><span class="w"> </span><span class="n">ndc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csma</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">net</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span><span class="p">(</span><span class="s">&quot;Assign IPv4 Addresses.&quot;</span><span class="p">);</span>
<span class="n">Ipv4AddressHelper</span><span class="w"> </span><span class="n">ipv4</span><span class="p">;</span>
<span class="n">ipv4</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="p">(</span><span class="s">&quot;192.168.1.0&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">NetMask</span><span class="p">(</span><span class="s">&quot;/24&quot;</span><span class="p">));</span>
<span class="n">Ipv4InterfaceContainer</span><span class="w"> </span><span class="n">ic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipv4</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">ndc</span><span class="p">);</span>
</pre></div>
</div>
<p>This method will add two global IPv4 addresses to the nodes.</p>
<p>Note that the addresses are assigned in sequence. As a consequence, the first Node / NetDevice
will have “192.168.1.1”, the second “192.168.1.2” and so on.</p>
<p>It is possible to repeat the above to assign more than one address to a node.
However, due to the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Ipv4AddressHelper</span></code> singleton nature, one should first assign all the
addresses of a network, then change the network base (<code class="docutils literal notranslate"><span class="pre">SetBase</span></code>), then do a new assignment.</p>
<p>Alternatively, it is possible to assign a specific address to a node:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">n0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">NodeContainer</span><span class="w"> </span><span class="nf">net</span><span class="p">(</span><span class="n">n0</span><span class="p">);</span>
<span class="n">CsmaHelper</span><span class="w"> </span><span class="n">csma</span><span class="p">;</span>
<span class="n">NetDeviceContainer</span><span class="w"> </span><span class="n">ndc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csma</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">net</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span><span class="p">(</span><span class="s">&quot;Specifically Assign an IPv4 Address.&quot;</span><span class="p">);</span>
<span class="n">Ipv4AddressHelper</span><span class="w"> </span><span class="n">ipv4</span><span class="p">;</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">NetDevice</span><span class="o">&gt;</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndc</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="o">-&gt;</span><span class="n">GetNode</span><span class="p">();</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Ipv4</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ipv4proto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">GetObject</span><span class="o">&lt;</span><span class="n">Ipv4</span><span class="o">&gt;</span><span class="p">();</span>
<span class="kt">int32_t</span><span class="w"> </span><span class="n">ifIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">ifIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipv4proto</span><span class="o">-&gt;</span><span class="n">GetInterfaceForDevice</span><span class="p">(</span><span class="n">device</span><span class="p">);</span>
<span class="n">Ipv4InterfaceAddress</span><span class="w"> </span><span class="n">ipv4Addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ipv4InterfaceAddress</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="p">(</span><span class="s">&quot;192.168.1.42&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">NetMask</span><span class="p">(</span><span class="s">&quot;/24&quot;</span><span class="p">));</span>
<span class="n">ipv4proto</span><span class="o">-&gt;</span><span class="n">AddAddress</span><span class="p">(</span><span class="n">ifIndex</span><span class="p">,</span><span class="w"> </span><span class="n">ipv4Addr</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="dhcp-assigned-ipv4-addresses">
<h3><span class="section-number">16.2.1.2. </span>DHCP assigned IPv4 addresses<a class="headerlink" href="#dhcp-assigned-ipv4-addresses" title="Link to this heading">¶</a></h3>
<p>DHCP is available in the internet-apps module. In order to use DHCP you have to have a
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">DhcpServer</span></code> application in a node (the DHC server node) and a <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">DhcpClient</span></code> application in
each of the nodes. Note that it not necessary that all the nodes in a subnet use DHCP. Some
nodes can have static addresses.</p>
<p>All the DHCP setup is performed though the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">DhcpHelper</span></code>  class. A complete example is in
<code class="docutils literal notranslate"><span class="pre">src/internet-apps/examples/dhcp-example.cc</span></code>.</p>
<p>Further info about the DHCP functionalities can be found in the <code class="docutils literal notranslate"><span class="pre">internet-apps</span></code> model documentation.</p>
</section>
</section>
<section id="tracing-in-the-ipv4-stack">
<h2><span class="section-number">16.2.2. </span>Tracing in the IPv4 Stack<a class="headerlink" href="#tracing-in-the-ipv4-stack" title="Link to this heading">¶</a></h2>
<p>The internet stack provides a number of trace sources in its various
protocol implementations.  These trace sources can be hooked using your own
custom trace code, or you can use our helper functions in some cases to
arrange for tracing to be enabled.</p>
<section id="tracing-in-arp">
<h3><span class="section-number">16.2.2.1. </span>Tracing in ARP<a class="headerlink" href="#tracing-in-arp" title="Link to this heading">¶</a></h3>
<p>ARP provides two trace hooks, one in the cache, and one in the layer three
protocol.  The trace accessor in the cache is given the name “Drop.”  When
a packet is transmitted over an interface that requires ARP, it is first
queued for transmission in the ARP cache until the required MAC address is
resolved.  There are a number of retries that may be done trying to get the
address, and if the maximum retry count is exceeded the packet in question
is dropped by ARP.  The single trace hook in the ARP cache is called,</p>
<ul class="simple">
<li><p>If an outbound packet is placed in the ARP cache pending address resolution
and no resolution can be made within the maximum retry count, the outbound
packet is dropped and this trace is fired;</p></li>
</ul>
<p>A second trace hook lives in the ARP L3 protocol (also named “Drop”) and may
be called for a  number of reasons.</p>
<ul class="simple">
<li><p>If an ARP reply is received for an entry that is not waiting for a reply,
the ARP reply packet is dropped and this trace is fired;</p></li>
<li><p>If an ARP reply is received for a non-existent entry, the ARP reply packet
is dropped and this trace is fired;</p></li>
<li><p>If an ARP cache entry is in the DEAD state (has timed out) and an ARP reply
packet is received, the reply packet is dropped and this trace is fired.</p></li>
<li><p>Each ARP cache entry has a queue of pending packets.  If the size of the
queue is exceeded, the outbound packet is dropped and this trace is fired.</p></li>
</ul>
</section>
<section id="tracing-in-ipv4">
<h3><span class="section-number">16.2.2.2. </span>Tracing in IPv4<a class="headerlink" href="#tracing-in-ipv4" title="Link to this heading">¶</a></h3>
<p>The IPv4 layer three protocol provides three trace hooks.  These are the
“Tx” (ns3::Ipv4L3Protocol::m_txTrace), “Rx” (ns3::Ipv4L3Protocol::m_rxTrace)
and “Drop” (ns3::Ipv4L3Protocol::m_dropTrace) trace sources.</p>
<p>The “Tx” trace is fired in a number of situations, all of which indicate that
a given packet is about to be sent down to a given ns3::Ipv4Interface.</p>
<ul class="simple">
<li><p>In the case of a packet destined for the broadcast address, the
Ipv4InterfaceList is iterated and for every interface that is up and can
fragment the packet or has a large enough MTU to transmit the packet,
the trace is hit.  See ns3::Ipv4L3Protocol::Send.</p></li>
<li><p>In the case of a packet that needs routing, the “Tx” trace may be fired
just before a packet is sent to the interface appropriate to the default
gateway.  See ns3::Ipv4L3Protocol::SendRealOut.</p></li>
<li><p>Also in the case of a packet that needs routing, the “Tx” trace may be
fired just before a packet is sent to the outgoing interface appropriate
to the discovered route.  See ns3::Ipv4L3Protocol::SendRealOut.</p></li>
</ul>
<p>The “Rx” trace is fired when a packet is passed from the device up to the
ns3::Ipv4L3Protocol::Receive function.</p>
<ul class="simple">
<li><p>In the receive function, the Ipv4InterfaceList is iterated, and if the
Ipv4Interface corresponding to the receiving device is found to be in the
UP state, the trace is fired.</p></li>
</ul>
<p>The “Drop” trace is fired in any case where the packet is dropped (in both
the transmit and receive paths).</p>
<ul class="simple">
<li><p>In the ns3::Ipv4Interface::Receive function, the packet is dropped and the
drop trace is hit if the interface corresponding to the receiving device
is in the DOWN state.</p></li>
<li><p>Also in the ns3::Ipv4Interface::Receive function, the packet is dropped and
the drop trace is hit if the checksum is found to be bad.</p></li>
<li><p>In ns3::Ipv4L3Protocol::Send, an outgoing packet bound for the broadcast
address is dropped and the “Drop” trace is fired if the “don’t fragment”
bit is set and fragmentation is available and required.</p></li>
<li><p>Also in ns3::Ipv4L3Protocol::Send, an outgoing packet destined for the
broadcast address is dropped and the “Drop” trace is hit if fragmentation
is not available and is required (MTU &lt; packet size).</p></li>
<li><p>In the case of a broadcast address, an outgoing packet is cloned for each
outgoing interface.  If any of the interfaces is in the DOWN state, the
“Drop” trace event fires with a reference to the copied packet.</p></li>
<li><p>In the case of a packet requiring a route, an outgoing packet is dropped
and the “Drop” trace event fires if no route to the remote host is found.</p></li>
<li><p>In ns3::Ipv4L3Protocol::SendRealOut, an outgoing packet being routed
is dropped and the “Drop” trace is fired if the “don’t fragment” bit is
set and fragmentation is available and required.</p></li>
<li><p>Also in ns3::Ipv4L3Protocol::SendRealOut, an outgoing packet being routed
is dropped and the “Drop” trace is hit if fragmentation is not available
and is required (MTU &lt; packet size).</p></li>
<li><p>An outgoing packet being routed is dropped and the “Drop” trace event fires
if the required Ipv4Interface is in the DOWN state.</p></li>
<li><p>If a packet is being forwarded, and the TTL is exceeded (see
ns3::Ipv4L3Protocol::DoForward), the packet is dropped and the “Drop” trace
event is fired.</p></li>
</ul>
</section>
</section>
<section id="explicit-congestion-notification-ecn-bits">
<h2><span class="section-number">16.2.3. </span>Explicit Congestion Notification (ECN) bits<a class="headerlink" href="#explicit-congestion-notification-ecn-bits" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>In IPv4, ECN bits are the last 2 bits in TOS field and occupy 14th and 15th
bits in the header.</p></li>
<li><p>The IPv4 header class defines an EcnType enum with all four ECN codepoints
(ECN_NotECT, ECN_ECT1, ECN_ECT0, ECN_CE) mentioned
in RFC 3168, and also a setter and getter method to handle ECN values in
the TOS field.</p></li>
</ul>
</section>
<section id="ipv4queuediscitem">
<h2><span class="section-number">16.2.4. </span>Ipv4QueueDiscItem<a class="headerlink" href="#ipv4queuediscitem" title="Link to this heading">¶</a></h2>
<p>The traffic control sublayer in <em>ns-3</em> handles objects of class
<code class="docutils literal notranslate"><span class="pre">QueueDiscItem</span></code> which are used to hold an ns3::Packet and an ns3::Header.
This is done to facilitate the marking of packets for Explicit
Congestion Notification.  The <code class="docutils literal notranslate"><span class="pre">Mark</span> <span class="pre">()</span></code> method is implemented in
Ipv4QueueDiscItem. It returns true if marking the packet is successful, i.e.,
it successfully sets the CE bit in the IPv4 header. The <code class="docutils literal notranslate"><span class="pre">Mark</span> <span class="pre">()</span></code> method
will return false, however, if the IPv4 header indicates the <code class="docutils literal notranslate"><span class="pre">ECN_NotECT</span></code>
codepoint.</p>
</section>
<section id="rfc-6621-duplicate-packet-detection">
<h2><span class="section-number">16.2.5. </span>RFC 6621 duplicate packet detection<a class="headerlink" href="#rfc-6621-duplicate-packet-detection" title="Link to this heading">¶</a></h2>
<p>To support mesh network protocols over broadcast-capable networks (e.g. Wi-Fi),
it is useful to have support for duplicate packet detection and filtering,
since nodes in a network may receive multiple copies of flooded multicast
packets arriving on different paths.  The <code class="docutils literal notranslate"><span class="pre">Ipv4L3Protocol</span></code> model in <em>ns-3</em>
has a model for hash-based duplicate packet detection (DPD) based on
Section 6.2.2 of (<span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc6621.html"><strong>RFC 6621</strong></a>).  The model, disabled by default, must be
enabled by setting <code class="docutils literal notranslate"><span class="pre">EnableRFC6621</span></code> to true.  A second attribute,
<code class="docutils literal notranslate"><span class="pre">DuplicateExpire</span></code>, sets the expiration delay for erasing the cache entry
of a packet in the duplicate cache; the delay value defaults to 1ms.</p>
</section>
<section id="neighborcache">
<h2><span class="section-number">16.2.6. </span>NeighborCache<a class="headerlink" href="#neighborcache" title="Link to this heading">¶</a></h2>
<p>NeighborCacheHelper provides a way to generate ARP cache automatically. It
generates needed ARP cache before simulation start to avoid the delay and message overhead of
address resolution in simulations that are focused on other performance aspects.
The state of entries which are generated by NeighborCacheHelper is <code class="docutils literal notranslate"><span class="pre">STATIC_AUTOGENERATED</span></code>,
which is similar to <code class="docutils literal notranslate"><span class="pre">PERMANENT</span></code>, but they are not manually added or removed by user, they
will be managed by NeighborCacheHelper when user need pre-generate cache.
When user is generating neighbor caches globally, neighbor caches will update dynamically when
IPv4 addresses are removed or added; when user is generating neighbor caches partially,
NeighborCacheHelper will take care of address removal, for adding address user may rerun a
reduced-scope PopulateNeighbor() again to pick up the new IP address or manually
add an entry to keep the neighbor cache up-to-date, the reason is that: when PopulateNeighborCache()
has previously been run with a scope less than global, the code does not know whether it was previously
run with a scope of Channel, NetDeviceContainer, or Ip interface container.
The source code for NeighborCache is located in <code class="docutils literal notranslate"><span class="pre">src/internet/helper/neighbor-cache-helper</span></code>
A complete example is in <code class="docutils literal notranslate"><span class="pre">src/internet/examples/neighbor-cache-example.cc</span></code>.</p>
<section id="usage">
<h3><span class="section-number">16.2.6.1. </span>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h3>
<p>The typical usages are:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="w"> </span><span class="n">Populate</span><span class="w"> </span><span class="n">neighbor</span><span class="w"> </span><span class="n">ARP</span><span class="w"> </span><span class="n">caches</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">devices</span><span class="o">:</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">NeighborCacheHelper</span><span class="w"> </span><span class="n">neighborCache</span><span class="p">;</span>
<span class="n">neighborCache</span><span class="p">.</span><span class="n">PopulateNeighborCache</span><span class="p">();</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Populate neighbor ARP caches for a given channel:</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">NeighborCacheHelper</span><span class="w"> </span><span class="n">neighborCache</span><span class="p">;</span>
<span class="n">neighborCache</span><span class="p">.</span><span class="n">PopulateNeighborCache</span><span class="p">(</span><span class="n">channel</span><span class="p">);</span><span class="w">     </span><span class="c1">// channel is the Ptr&lt;Channel&gt; want to generate ARP caches</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Populate neighbor ARP caches for devices in a given NetDeviceContainer:</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">NeighborCacheHelper</span><span class="w"> </span><span class="n">neighborCache</span><span class="p">;</span>
<span class="n">neighborCache</span><span class="p">.</span><span class="n">PopulateNeighborCache</span><span class="p">(</span><span class="n">netDevices</span><span class="p">);</span><span class="w">   </span><span class="c1">// netDevices is the NetDeviceContainer want to generate ARP caches</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Populate neighbor ARP caches for a given Ipv4InterfaceContainer:</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">NeighborCacheHelper</span><span class="w"> </span><span class="n">neighborCache</span><span class="p">;</span>
<span class="n">neighborCache</span><span class="p">.</span><span class="n">PopulateNeighborCache</span><span class="p">(</span><span class="n">interfaces</span><span class="p">);</span><span class="w">    </span><span class="c1">// interfaces is the Ipv4InterfaceContainer want to generate ARP caches</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">16.2. IPv4</a><ul>
<li><a class="reference internal" href="#ipv4-addresses-assignment">16.2.1. IPv4 addresses assignment</a><ul>
<li><a class="reference internal" href="#manually-assigned-ipv4-addresses">16.2.1.1. Manually assigned IPv4 addresses</a></li>
<li><a class="reference internal" href="#dhcp-assigned-ipv4-addresses">16.2.1.2. DHCP assigned IPv4 addresses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tracing-in-the-ipv4-stack">16.2.2. Tracing in the IPv4 Stack</a><ul>
<li><a class="reference internal" href="#tracing-in-arp">16.2.2.1. Tracing in ARP</a></li>
<li><a class="reference internal" href="#tracing-in-ipv4">16.2.2.2. Tracing in IPv4</a></li>
</ul>
</li>
<li><a class="reference internal" href="#explicit-congestion-notification-ecn-bits">16.2.3. Explicit Congestion Notification (ECN) bits</a></li>
<li><a class="reference internal" href="#ipv4queuediscitem">16.2.4. Ipv4QueueDiscItem</a></li>
<li><a class="reference internal" href="#rfc-6621-duplicate-packet-detection">16.2.5. RFC 6621 duplicate packet detection</a></li>
<li><a class="reference internal" href="#neighborcache">16.2.6. NeighborCache</a><ul>
<li><a class="reference internal" href="#usage">16.2.6.1. Usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="internet-stack.html"
                          title="previous chapter"><span class="section-number">16.1. </span>Internet Stack</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="ipv6.html"
                          title="next chapter"><span class="section-number">16.3. </span>IPv6</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ipv4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ipv6.html" title="16.3. IPv6"
             >next</a> |</li>
        <li class="right" >
          <a href="internet-stack.html" title="16.1. Internet Stack"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="internet-models.html" ><span class="section-number">16. </span>Internet Models (IP, TCP, Routing, UDP)</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">16.2. </span>IPv4</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2006-2019, ns-3 project.
      Last updated on Mar 22, 2024 12:22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>