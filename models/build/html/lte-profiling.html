

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Profiling Documentation &#8212; Model Library</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="lte-references.html" />
    <link rel="prev" title="Testing Documentation" href="lte-testing.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico" 
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>
      

  </head><body>
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0" width="100%">
      <tbody>
	<tr style="height: 56px;">
	  <td id="projectlogo">
	    <a id="ns3_home1"
	       href="http://www.nsnam.org/">
	       <img alt="ns-3 Logo"
		    src="_static/ns-3-inverted-notext-small.png"/>
	    </a>
	  </td>
	  <td id="projecttext">
	    <div id="projectbrief">A Discrete-Event Network Simulator</div>
	      <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
	  </td>
	      
	  <td id="ns3-menu">
	    <div class="menu">
	      <ul >
	        <li><a id="ns3_home2"
		       href="http://www.nsnam.org/"
		       >&nbsp;&nbsp;Home</a>
	        </li>
	        <li><span
		      onmouseover="mopen('mTuts')" 
		      onmouseout="mclosetime()"
			>Tutorials &nbsp;&#x25BC;</span>
		    <div id="mTuts" 
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_tut"
			 href="/docs/tutorial/html/index.html"
			  >English</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDocs')" 
		      onmouseout="mclosetime()"
			>Docs &nbsp;&nbsp;&nbsp;&#x25BC;</span>
		    <div id="mDocs"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_wiki"
			 href="http://www.nsnam.org/wiki"
			 >Wiki</a><br/>
		      <a id="ns3_man"
			 href="/docs/manual/html/index.html"
			 >Manual</a><br/>
		      <a id="ns3_mod"
			 href="/docs/models/html/index.html"
			 >Models</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDev')" 
		      onmouseout="mclosetime()"
			>Develop &#x25BC;</span>
		    <div id="mDev"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_api"
			 href="/docs/doxygen/html/index.html"
			 >API</a><br/>
		      <a id="ns3_bugs"
		       href="http://www.nsnam.org/bugzilla/">Bugs</a>
	        </li>
	      </ul>
	    </div>
	  </td>
	  <td id="projectsection">
	    <span style="margin-right:10px">Models</span>
	  </td>
	</tr>
      </tbody>
    </table>
    <script  type="text/javascript">ns3_write_links()</script>
  </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="lte-references.html" title="References"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lte-testing.html" title="Testing Documentation"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="lte.html" accesskey="U">LTE Module</a><span class="navelem">&nbsp;</span></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="profiling-documentation">
<h1>Profiling Documentation<a class="headerlink" href="#profiling-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-and-objectives">
<h2>Overview and objectives<a class="headerlink" href="#overview-and-objectives" title="Permalink to this headline">¶</a></h2>
<p>The main objective of the profiling carried out is to assess the simulator performance on a broad set of scenarios. This evaluation provides reference values for simulation running times and memory consumption figures. It also helps to identify potential performance improvements and to check for scalability problems when increasing the number of eNodeB and UEs attached to those.</p>
<p>In the following sections, a detailed description of the general profiling framework employed to perform the study is introduced. It also includes details on the main performed tests and its results evaluation.</p>
</div>
<div class="section" id="framework-description">
<h2>Framework description<a class="headerlink" href="#framework-description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simulation-scripts">
<h3>Simulation scripts<a class="headerlink" href="#simulation-scripts" title="Permalink to this headline">¶</a></h3>
<p>The simulation script used for all the E-UTRAN results showed in this documentation is located at <code class="docutils literal notranslate"><span class="pre">src/lte/examples/lena-profiling.cc</span></code>. It uses the complete PHY and MAC UE/eNodeB implementation with a simplified RLC implementation on top. This script generates a squared grid topology, placing a eNodeB at the centre of each square. UEs attached to this node are scattered randomly across the square (using a random uniform distribution along X and Y axis). If <em>BuildingPropagationModel</em> is used, the squares are replaced by rooms. To generate the UL and DL traffic, the RLC implementation always report data to be transferred.</p>
<div class="figure align-center" id="id3">
<span id="fig-eutranprofilingscenario"></span><a class="reference internal image-reference" href="_images/eutran-profiling-scenario.png"><img alt="_images/eutran-profiling-scenario.png" src="_images/eutran-profiling-scenario.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">E-UTRAN</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>For the EPC results, the script is <code class="docutils literal notranslate"><span class="pre">src/lte/examples/lena-simple-epc.cc</span></code>. It uses a complete E-UTRAN implementation (PHY+MAC+RLC/UM+PDCP) and the most relevant EPC user plane entities the PGW and SGW, including GTP-U tunneling. This script generates a given number of eNodeBs, distributed across a line and attaches a single UE to every eNodeB. It also creates an EPC network and an external host connected to it through the Internet. Each UE sends and receives data to and from the remote host. In addition, each UE is also sending data to the UE camped in the adjacent eNodeB.</p>
<div class="figure align-center" id="id4">
<span id="fig-epcprofilingscenario"></span><a class="reference internal image-reference" href="_images/epc-profiling-scenario.png"><img alt="_images/epc-profiling-scenario.png" src="_images/epc-profiling-scenario.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Propagation Model</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>RLC and MAC traces are enabled for all UEs and all eNodeBs and those traces are written to disk directly. The MAC scheduler used is <em>round robin</em>.</p>
<div class="section" id="simulation-input-parameters">
<h4>Simulation input parameters<a class="headerlink" href="#simulation-input-parameters" title="Permalink to this headline">¶</a></h4>
<p>The <em>lena-profiling</em> simulation script accepts the following input parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">simTime</span></code>: time to simulate (in seconds)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nUe</span></code>: number of UEs attached to each eNodeB</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nEnb</span></code>: number of eNodeB composing the grid per floor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nFloors</span></code>: number of floors, 0 for <em>Friis propagation model</em> (no walls), 1 or greater for <em>Building propagation model</em> generating a nFloors-storey building.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceDirectory</span></code>: destination directory where simulation traces will be stored</p></li>
</ul>
</div></blockquote>
<p>The <em>lena-simple-epc</em> script accepts those other parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">simTime</span></code>: time to simulate (in seconds)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numberOfNodes</span></code>: number of eNodeB + UE pairs created</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="time-measurement">
<h3>Time measurement<a class="headerlink" href="#time-measurement" title="Permalink to this headline">¶</a></h3>
<p>Running time is measured using default Linux shell command <strong>time</strong>. This command counts how much user time the execution of a program takes.</p>
</div>
<div class="section" id="perl-script">
<h3>Perl script<a class="headerlink" href="#perl-script" title="Permalink to this headline">¶</a></h3>
<p>To simplify the process of running the profiling script for a wide range of values and collecting its timing data, a simple Perl script to automate the complete process is provided. It is placed in <code class="docutils literal notranslate"><span class="pre">src/lte/test/lte-test-run-time.pl</span></code> for <em>lena-profiling</em> and in <code class="docutils literal notranslate"><span class="pre">src/lte/epc-test-run-time.pl</span></code> for <em>lena-simple-epc</em>. It simply runs a batch of simulations with a range of parameters and stores the timing results in a CSV file called <em>lteTimes.csv</em> and <em>epcTimes.csv</em> respectively. The range of values each parameter sweeps can be modified editing the corresponding script.</p>
<div class="section" id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h4>
<dl class="simple">
<dt>The following Perl modules are required to use the provided script, all of them available from CPAN:</dt><dd><ul class="simple">
<li><p>IO::CaptureOutput</p></li>
<li><p>Statistics::Descriptive</p></li>
</ul>
</dd>
</dl>
<p>For installing the modules, simply use the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">perl</span> <span class="pre">-MCPAN</span> <span class="pre">-e</span> <span class="pre">'install</span> <span class="pre">moduleName'</span></code></p>
</div>
<div class="section" id="plotting-results">
<h4>Plotting results<a class="headerlink" href="#plotting-results" title="Permalink to this headline">¶</a></h4>
<p>To plot the results obtained from running the Perl scripts, two gnuplot scripts are provided, in <code class="docutils literal notranslate"><span class="pre">src/lte/test/lte-test-run-plot</span></code> and <code class="docutils literal notranslate"><span class="pre">src/lte/test/epc-test-run-plot</span></code>. Most of the plots available in this documentation can be reproduced with those, typing the commands <code class="docutils literal notranslate"><span class="pre">gnuplot</span> <span class="pre">&lt;</span> <span class="pre">src/lte/test/lte-test-run-plot</span></code>  and  <code class="docutils literal notranslate"><span class="pre">gnuplot</span> <span class="pre">&lt;</span> <span class="pre">src/lte/test/epc-test-run-plot</span></code>.</p>
</div>
</div>
<div class="section" id="reference-software-and-equipment">
<h3>Reference software and equipment<a class="headerlink" href="#reference-software-and-equipment" title="Permalink to this headline">¶</a></h3>
<p>All timing tests had been run in a Intel Pentium IV 3.00 GHz machine with 512 Mb of RAM memory running Fedora Core 10 with a 2.6.27.41-170.2.117 kernel, storing the traces directly to the hard disk.</p>
<p>Also, as a reference configuration, the build has been configured static and optimized. The exact <code class="docutils literal notranslate"><span class="pre">waf</span></code> command issued is:</p>
<p><code class="docutils literal notranslate"><span class="pre">CXXFLAGS=&quot;-O3</span> <span class="pre">-w&quot;</span> <span class="pre">./waf</span> <span class="pre">-d</span> <span class="pre">optimized</span> <span class="pre">configure</span> <span class="pre">--enable-static</span> <span class="pre">--enable-examples</span> <span class="pre">--enable-modules=lte</span></code></p>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="e-utran">
<h3>E-UTRAN<a class="headerlink" href="#e-utran" title="Permalink to this headline">¶</a></h3>
<p>The following results and figures had been obtained with LENA <strong>changeset 2c5b0d697717</strong>.</p>
<div class="section" id="running-time">
<h4>Running time<a class="headerlink" href="#running-time" title="Permalink to this headline">¶</a></h4>
<p>This scenario, evaluates the running time for a fixed simulation time (10s) and Friis propagation mode increasing the number of UEs attached to each eNodeB and the number of planted eNodeBs in the scenario.</p>
<div class="figure align-center" id="id5">
<span id="fig-runtime"></span><a class="reference internal image-reference" href="_images/runningTime10s.png"><img alt="_images/runningTime10s.png" src="_images/runningTime10s.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Running time</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>The figure shows the expected behaviour, since it increases linearly respect the number of UEs per eNodeB and quadratically respect the total number of eNodeBs.</p>
</div>
<div class="section" id="propagation-model">
<h4>Propagation model<a class="headerlink" href="#propagation-model" title="Permalink to this headline">¶</a></h4>
<p>The objective of this scenario is to evaluate the impact of the propagation model complexity in the overall run time figures. Therefore, the same scenario is simulated twice: once using the more simple Friis model, once with the more complex Building model. The rest of the parameters (e.g. number of eNodeB and of UE attached per eNodeB) were maintained. The timing results for both models are compared in the following figure.</p>
<div class="figure align-center" id="id6">
<span id="fig-propagationmodel"></span><a class="reference internal image-reference" href="_images/propagationModel.png"><img alt="_images/propagationModel.png" src="_images/propagationModel.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Propagation Model</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>In this situation, results are also coherent with what is expected. The more complex the model, the higher the running time. Moreover, as the number of computed path losses increases (i.e. more UEs per eNodeB or more eNodeBs) the extra complexity of the propagation model drives the running time figures further apart.</p>
</div>
<div class="section" id="simulation-time">
<h4>Simulation time<a class="headerlink" href="#simulation-time" title="Permalink to this headline">¶</a></h4>
<p>In this scenario, for a fixed set of UEs per eNodeB, different simulation times had been run. As the simulation time increases, running time should also increase linearly, i.e. for a given scenario, simulate four seconds should take twice times what it takes to simulate two seconds. The slope of this line is a function of the complexity of the scenario: the more eNodeB / UEs placed, the higher the slope of the line.</p>
<div class="figure align-center" id="id7">
<span id="fig-simulationtime"></span><a class="reference internal image-reference" href="_images/simulationTime.png"><img alt="_images/simulationTime.png" src="_images/simulationTime.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Simulation time</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="memory-usage">
<h4>Memory usage<a class="headerlink" href="#memory-usage" title="Permalink to this headline">¶</a></h4>
<p>Massif tool to profile memory consumption</p>
<div class="figure align-center" id="id8">
<span id="fig-profilingmemory"></span><a class="reference internal image-reference" href="_images/profiling-memory.png"><img alt="_images/profiling-memory.png" src="_images/profiling-memory.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Memory profile</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="epc">
<h3>EPC<a class="headerlink" href="#epc" title="Permalink to this headline">¶</a></h3>
<p>The following results and figures had been obtained with LENA <strong>changeset e8b3ccdf6673</strong>. The rationale behind the two scenarios profiled on this section is the same than for the E-UTRA part.</p>
<div class="section" id="id1">
<h4>Running time<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Running time evolution is quadratic since we increase at the same time the number of eNodeB and the number of UEs.</p>
<div class="figure align-center" id="id9">
<span id="fig-epcruntime"></span><a class="reference internal image-reference" href="_images/epcRunningTime.png"><img alt="_images/epcRunningTime.png" src="_images/epcRunningTime.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Running time</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>To estimate the additional complexity of the upper LTE Radio Protocol Stack model and the EPC model, we compare two scenarios using the simplified E-UTRAN version (using only PHY, MAC and the simplified RLC/SM, with no EPC and no ns-3 applications) against the complete E-UTRAN + EPC (with UM RLC, PDCP, end-to-end IP networking and regular ns-3 applications). Both configuration have been tested with the same number of UEs per eNodeB, the same number of eNodeBs, and approximately the same volume of transmitted data (an exact match was not possible due to the different ways in which packets are generated in the two configurations).</p>
<div class="figure align-center" id="id10">
<span id="fig-epceutranruntime"></span><a class="reference internal image-reference" href="_images/epcEutranRunningTime.png"><img alt="_images/epcEutranRunningTime.png" src="_images/epcEutranRunningTime.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">EPC E-UTRAN running time</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>From the figure, it is evident that the additional complexity of using the upper LTE stack plus the EPC model translates approximately into a doubling of the execution time of the simulations. We believe that, considered all the new features that have been added, this figure is acceptable.</p>
</div>
<div class="section" id="id2">
<h4>Simulation time<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Finally, again the linearity of the running time as the simulation time increases gets validated through a set of experiments, as the following figure shows.</p>
<div class="figure align-center" id="id11">
<span id="fig-epcsimtime"></span><a class="reference internal image-reference" href="_images/epcSimulationTime.png"><img alt="_images/epcSimulationTime.png" src="_images/epcSimulationTime.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Simulation time</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Profiling Documentation</a><ul>
<li><a class="reference internal" href="#overview-and-objectives">Overview and objectives</a></li>
<li><a class="reference internal" href="#framework-description">Framework description</a><ul>
<li><a class="reference internal" href="#simulation-scripts">Simulation scripts</a><ul>
<li><a class="reference internal" href="#simulation-input-parameters">Simulation input parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#time-measurement">Time measurement</a></li>
<li><a class="reference internal" href="#perl-script">Perl script</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#plotting-results">Plotting results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-software-and-equipment">Reference software and equipment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results">Results</a><ul>
<li><a class="reference internal" href="#e-utran">E-UTRAN</a><ul>
<li><a class="reference internal" href="#running-time">Running time</a></li>
<li><a class="reference internal" href="#propagation-model">Propagation model</a></li>
<li><a class="reference internal" href="#simulation-time">Simulation time</a></li>
<li><a class="reference internal" href="#memory-usage">Memory usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#epc">EPC</a><ul>
<li><a class="reference internal" href="#id1">Running time</a></li>
<li><a class="reference internal" href="#id2">Simulation time</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lte-testing.html"
                        title="previous chapter">Testing Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lte-references.html"
                        title="next chapter">References</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/lte-profiling.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="lte-references.html" title="References"
             >next</a> |</li>
        <li class="right" >
          <a href="lte-testing.html" title="Testing Documentation"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="lte.html" >LTE Module</a><span class="navelem">&nbsp;</span></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2006-2019.
      Last updated on Apr 29, 2020 17:37.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.
    </div>
  </body>
</html>