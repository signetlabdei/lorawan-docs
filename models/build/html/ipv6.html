

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>IPv6 &#8212; Model Library</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Routing overview" href="routing-overview.html" />
    <link rel="prev" title="IPv4" href="ipv4.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico" 
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>
      

  </head><body>
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0" width="100%">
      <tbody>
	<tr style="height: 56px;">
	  <td id="projectlogo">
	    <a id="ns3_home1"
	       href="http://www.nsnam.org/">
	       <img alt="ns-3 Logo"
		    src="_static/ns-3-inverted-notext-small.png"/>
	    </a>
	  </td>
	  <td id="projecttext">
	    <div id="projectbrief">A Discrete-Event Network Simulator</div>
	      <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
	  </td>
	      
	  <td id="ns3-menu">
	    <div class="menu">
	      <ul >
	        <li><a id="ns3_home2"
		       href="http://www.nsnam.org/"
		       >&nbsp;&nbsp;Home</a>
	        </li>
	        <li><span
		      onmouseover="mopen('mTuts')" 
		      onmouseout="mclosetime()"
			>Tutorials &nbsp;&#x25BC;</span>
		    <div id="mTuts" 
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_tut"
			 href="/docs/tutorial/html/index.html"
			  >English</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDocs')" 
		      onmouseout="mclosetime()"
			>Docs &nbsp;&nbsp;&nbsp;&#x25BC;</span>
		    <div id="mDocs"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_wiki"
			 href="http://www.nsnam.org/wiki"
			 >Wiki</a><br/>
		      <a id="ns3_man"
			 href="/docs/manual/html/index.html"
			 >Manual</a><br/>
		      <a id="ns3_mod"
			 href="/docs/models/html/index.html"
			 >Models</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDev')" 
		      onmouseout="mclosetime()"
			>Develop &#x25BC;</span>
		    <div id="mDev"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_api"
			 href="/docs/doxygen/html/index.html"
			 >API</a><br/>
		      <a id="ns3_bugs"
		       href="http://www.nsnam.org/bugzilla/">Bugs</a>
	        </li>
	      </ul>
	    </div>
	  </td>
	  <td id="projectsection">
	    <span style="margin-right:10px">Models</span>
	  </td>
	</tr>
      </tbody>
    </table>
    <script  type="text/javascript">ns3_write_links()</script>
  </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="routing-overview.html" title="Routing overview"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ipv4.html" title="IPv4"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="internet-models.html" accesskey="U">Internet Models (IP, TCP, Routing, UDP, Internet Applications)</a><span class="navelem">&nbsp;</span></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ipv6">
<h1>IPv6<a class="headerlink" href="#ipv6" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes the <em>ns-3</em> IPv6 model capabilities and limitations along with its
usage and examples.</p>
<div class="section" id="ipv6-model-description">
<h2>IPv6 model description<a class="headerlink" href="#ipv6-model-description" title="Permalink to this headline">¶</a></h2>
<p>The IPv6 model is loosely patterned after the Linux implementation;
the implementation is not complete as some features of IPv6 are not of
much interest to simulation studies, and some features of IPv6 are simply
not modeled yet in <em>ns-3</em>.</p>
<p>The base class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Ipv6</span></code>
defines a generic API, while the class <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Ipv6L3Protocol</span></code> is the actual class
implementing the protocol. The actual classes used by the IPv6 stack are located mainly
in the directory <code class="docutils literal notranslate"><span class="pre">src/internet</span></code>.</p>
<p>The implementation of IPv6 is contained in the following files:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>src/internet/model/icmpv6-header.{cc,h}
src/internet/model/icmpv6-l4-protocol.{cc,h}
src/internet/model/ipv6.{cc,h}
src/internet/model/ipv6-address-generator.{cc,h}
src/internet/model/ipv6-autoconfigured-prefix.{cc,h}
src/internet/model/ipv6-end-point.{cc,h}
src/internet/model/ipv6-end-point-demux.{cc,h}
src/internet/model/ipv6-extension.{cc,h}
src/internet/model/ipv6-extension-demux.{cc,h}
src/internet/model/ipv6-extension-header.{cc,h}
src/internet/model/ipv6-header.{cc,h}
src/internet/model/ipv6-interface.{cc,h}
src/internet/model/ipv6-interface-address.{cc,h}
src/internet/model/ipv6-l3-protocol.{cc,h}
src/internet/model/ipv6-list-routing.{cc,h}
src/internet/model/ipv6-option.{cc,h}
src/internet/model/ipv6-option-demux.{cc,h}
src/internet/model/ipv6-option-header.{cc,h}
src/internet/model/ipv6-packet-info-tag.{cc,h}
src/internet/model/ipv6-pmtu-cache.{cc,h}
src/internet/model/ipv6-raw-socket-factory.{cc,h}
src/internet/model/ipv6-raw-socket-factory-impl.{cc,h}
src/internet/model/ipv6-raw-socket-impl.{cc,h}
src/internet/model/ipv6-route.{cc,h}
src/internet/model/ipv6-routing-protocol.{cc,h}
src/internet/model/ipv6-routing-table-entry.{cc,h}
src/internet/model/ipv6-static-routing.{cc,h}
src/internet/model/ndisc-cache.{cc,h}
src/network/utils/inet6-socket-address.{cc,h}
src/network/utils/ipv6-address.{cc,h}
</pre></div>
</div>
<p>Also some helpers are involved with IPv6:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>src/internet/helper/internet-stack-helper.{cc,h}
src/internet/helper/ipv6-address-helper.{cc,h}
src/internet/helper/ipv6-interface-container.{cc,h}
src/internet/helper/ipv6-list-routing-helper.{cc,h}
src/internet/helper/ipv6-routing-helper.{cc,h}
src/internet/helper/ipv6-static-routing-helper.{cc,h}
</pre></div>
</div>
<p>The model files can be roughly divided into:</p>
<ul class="simple">
<li><p>protocol models (e.g., ipv6, ipv6-l3-protocol, icmpv6-l4-protocol, etc.)</p></li>
<li><p>routing models (i.e., anything with ‘routing’ in its name)</p></li>
<li><p>sockets and interfaces (e.g., ipv6-raw-socket, ipv6-interface, ipv6-end-point, etc.)</p></li>
<li><p>address-related things</p></li>
<li><p>headers, option headers, extension headers, etc.</p></li>
<li><p>accessory classes (e.g., ndisc-cache)</p></li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The following description is based on using the typical helpers found in the example code.</p>
<p>IPv6 does not need to be activated in a node. it is automatically added to the
available protocols once the Internet Stack is installed.</p>
<p>In order to <em>not</em> install IPv6 along with IPv4, it is possible to use
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::InternetStackHelper</span></code> method <cite>SetIpv6StackInstall (bool enable)</cite>
before installing the InternetStack in the nodes.</p>
<p>Note that to have an IPv6-only network (i.e., to not install the IPv4 stack in a node)
one should use <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::InternetStackHelper</span></code> method <cite>SetIpv4StackInstall (bool enable)</cite>
before the stack installation.</p>
<p>As an example, in the following code node 0 will have both IPv4 and IPv6, node 1 only
only IPv6 and node 2 only IPv4:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NodeContainer</span> <span class="n">n</span><span class="p">;</span>
<span class="n">n</span><span class="p">.</span><span class="n">Create</span> <span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="n">InternetStackHelper</span> <span class="n">internet</span><span class="p">;</span>
<span class="n">InternetStackHelper</span> <span class="n">internetV4only</span><span class="p">;</span>
<span class="n">InternetStackHelper</span> <span class="n">internetV6only</span><span class="p">;</span>

<span class="n">internetV4only</span><span class="p">.</span><span class="n">SetIpv6StackInstall</span> <span class="p">(</span><span class="nb">false</span><span class="p">);</span>
<span class="n">internetV6only</span><span class="p">.</span><span class="n">SetIpv4StackInstall</span> <span class="p">(</span><span class="nb">false</span><span class="p">);</span>

<span class="n">internet</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">internetV6only</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">internetV4only</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</pre></div>
</div>
<div class="section" id="ipv6-addresses-assignment">
<h3>IPv6 addresses assignment<a class="headerlink" href="#ipv6-addresses-assignment" title="Permalink to this headline">¶</a></h3>
<p>In order to use IPv6 on a network, the first thing to do is assigning IPv6 addresses.</p>
<p>Any IPv6-enabled <em>ns-3</em> node will have at least one NetDevice: the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::LoopbackNetDevice</span></code>.
The loopback device address is <code class="docutils literal notranslate"><span class="pre">::1</span></code>.
All the other NetDevices will have one or more IPv6 addresses:</p>
<ul class="simple">
<li><p>One link-local address: <code class="docutils literal notranslate"><span class="pre">fe80::interface</span> <span class="pre">ID</span></code>, where <code class="docutils literal notranslate"><span class="pre">interface</span> <span class="pre">ID</span></code> is derived from the NetDevice MAC address.</p></li>
<li><p>Zero or more global addresses, e.g., <code class="docutils literal notranslate"><span class="pre">2001:db8::1</span></code>.</p></li>
</ul>
<p>Typically the first address on an interface will be the link-local one, with the global
address(es) being the following ones.</p>
<p>IPv6 global addresses might be:</p>
<ul class="simple">
<li><p>manually assigned</p></li>
<li><p>auto-generated</p></li>
</ul>
<p><em>ns-3</em> can use both methods, and it’s quite important to understand the implications of both.</p>
<div class="section" id="manually-assigned-ipv6-addresses">
<h4>Manually assigned IPv6 addresses<a class="headerlink" href="#manually-assigned-ipv6-addresses" title="Permalink to this headline">¶</a></h4>
<p>This is probably the easiest and most used method. As an example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">n0</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="p">();</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="p">();</span>
<span class="n">NodeContainer</span> <span class="nf">net</span> <span class="p">(</span><span class="n">n0</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
<span class="n">CsmaHelper</span> <span class="n">csma</span><span class="p">;</span>
<span class="n">NetDeviceContainer</span> <span class="n">ndc</span> <span class="o">=</span> <span class="n">csma</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">net</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span> <span class="p">(</span><span class="s">&quot;Assign IPv6 Addresses.&quot;</span><span class="p">);</span>
<span class="n">Ipv6AddressHelper</span> <span class="n">ipv6</span><span class="p">;</span>
<span class="n">ipv6</span><span class="p">.</span><span class="n">SetBase</span> <span class="p">(</span><span class="n">Ipv6Address</span> <span class="p">(</span><span class="s">&quot;2001:db8::&quot;</span><span class="p">),</span> <span class="n">Ipv6Prefix</span> <span class="p">(</span><span class="mi">64</span><span class="p">));</span>
<span class="n">Ipv6InterfaceContainer</span> <span class="n">ic</span> <span class="o">=</span> <span class="n">ipv6</span><span class="p">.</span><span class="n">Assign</span> <span class="p">(</span><span class="n">ndc</span><span class="p">);</span>
</pre></div>
</div>
<p>This method will add two global IPv6 addresses to the nodes. Note that, as usual for IPv6,
all the nodes will also have a link-local address. Typically the first address on an
interface will be the link-local one, with the global address(es) being the following ones.</p>
<p>Note that the global addresses will be derived from the MAC address. As a consequence, expect
to have addresses similar to <code class="docutils literal notranslate"><span class="pre">2001:db8::200:ff:fe00:1</span></code>.</p>
<p>It is possible to repeat the above to assign more than one global address to a node.
However, due to the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Ipv6AddressHelper</span></code> singleton nature, one should first assign all the
addresses of a network, then change the network base (<code class="docutils literal notranslate"><span class="pre">SetBase</span></code>), then do a new assignment.</p>
<p>Alternatively, it is possible to assign a specific address to a node:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">n0</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="p">();</span>
<span class="n">NodeContainer</span> <span class="nf">net</span> <span class="p">(</span><span class="n">n0</span><span class="p">);</span>
<span class="n">CsmaHelper</span> <span class="n">csma</span><span class="p">;</span>
<span class="n">NetDeviceContainer</span> <span class="n">ndc</span> <span class="o">=</span> <span class="n">csma</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">net</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span> <span class="p">(</span><span class="s">&quot;Specifically Assign an IPv6 Address.&quot;</span><span class="p">);</span>
<span class="n">Ipv6AddressHelper</span> <span class="n">ipv6</span><span class="p">;</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">NetDevice</span><span class="o">&gt;</span> <span class="n">device</span> <span class="o">=</span> <span class="n">ndc</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">device</span><span class="o">-&gt;</span><span class="n">GetNode</span> <span class="p">();</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">Ipv6</span><span class="o">&gt;</span> <span class="n">ipv6proto</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">GetObject</span><span class="o">&lt;</span><span class="n">Ipv6</span><span class="o">&gt;</span> <span class="p">();</span>
<span class="kt">int32_t</span> <span class="n">ifIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">ifIndex</span> <span class="o">=</span> <span class="n">ipv6proto</span><span class="o">-&gt;</span><span class="n">GetInterfaceForDevice</span> <span class="p">(</span><span class="n">device</span><span class="p">);</span>
<span class="n">Ipv6InterfaceAddress</span> <span class="n">ipv6Addr</span> <span class="o">=</span> <span class="n">Ipv6InterfaceAddress</span> <span class="p">(</span><span class="n">Ipv6Address</span> <span class="p">(</span><span class="s">&quot;2001:db8:f00d:cafe::42&quot;</span><span class="p">),</span> <span class="n">Ipv6Prefix</span> <span class="p">(</span><span class="mi">64</span><span class="p">));</span>
<span class="n">ipv6proto</span><span class="o">-&gt;</span><span class="n">AddAddress</span> <span class="p">(</span><span class="n">ifIndex</span><span class="p">,</span> <span class="n">ipv6Addr</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="auto-generated-ipv6-addresses">
<h5>Auto-generated IPv6 addresses<a class="headerlink" href="#auto-generated-ipv6-addresses" title="Permalink to this headline">¶</a></h5>
<p>This is accomplished by relying on the RADVD protocol, implemented by the class
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Radvd</span></code>. A helper class is available, which can be used to ease the most
common tasks, e.g., setting up a prefix on an interface, if it is announced periodically,
and if the router is the default router for that interface.</p>
<p>A fine grain configuration is possible though the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">RadvdInterface</span></code> class, which
allows to setup every parameter of the announced router advertisement on a given interface.</p>
<p>It is worth mentioning that the configurations must be set up before installing the
application in the node.</p>
<p>Upon using this method, the nodes will acquire dynamically (i.e., during the simulation)
one (or more) global address(es) according to the RADVD configuration.
These addresses will be bases on the RADVD announced prefix and the node’s EUI-64.</p>
<p>Examples of RADVD use are shown in <code class="docutils literal notranslate"><span class="pre">examples/ipv6/radvd.cc</span></code>
and <code class="docutils literal notranslate"><span class="pre">examples/ipv6/radvd-two-prefix.cc</span></code>.</p>
</div>
<div class="section" id="random-generated-ipv6-addresses">
<h5>Random-generated IPv6 addresses<a class="headerlink" href="#random-generated-ipv6-addresses" title="Permalink to this headline">¶</a></h5>
<p>While IPv6 real nodes will use randomly generated addresses to protect privacy, <em>ns-3</em>
does NOT have this capability. This feature haven’t been so far considered as interesting
for simulation.</p>
</div>
<div class="section" id="duplicate-address-detection-dad">
<h5>Duplicate Address Detection (DAD)<a class="headerlink" href="#duplicate-address-detection-dad" title="Permalink to this headline">¶</a></h5>
<p>Nodes will perform DAD (it can be disabled using an <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Icmpv6L4Protocol</span></code> attribute).
Upon receiving a DAD, however, nodes will not react to it. As is: DAD reaction is
incomplete so far.
The main reason relies on the missing random-generated address capability. Moreover,
since <em>ns-3</em> nodes will usually be well-behaving, there shouldn’t be any Duplicate Address.
This might be changed in the future, so as to avoid issues with real-world
integrated simulations.</p>
</div>
</div>
</div>
<div class="section" id="explicit-congestion-notification-ecn-bits-in-ipv6">
<h3>Explicit Congestion Notification (ECN) bits in IPv6<a class="headerlink" href="#explicit-congestion-notification-ecn-bits-in-ipv6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>In IPv6, ECN bits are the last 2 bits of the Traffic class and occupy 10th and 11th bit
in the header.</p></li>
<li><p>The IPv6 header class defines an EcnType enum with all four ECN codepoints
(ECN_NotECT, ECN_ECT1, ECN_ECT0, ECN_CE) mentioned
in RFC 3168, and also a setter and getter method to handle ECN values in
the Traffic Class field.</p></li>
</ul>
</div>
</div>
<div class="section" id="ipv6queuediscitem">
<h2>Ipv6QueueDiscItem<a class="headerlink" href="#ipv6queuediscitem" title="Permalink to this headline">¶</a></h2>
<p>The traffic control sublayer in <em>ns-3</em> handles objects of class
<code class="docutils literal notranslate"><span class="pre">QueueDiscItem</span></code> which are used to hold an ns3::Packet and an ns3::Header.
This is done to facilitate the marking of packets for Explicit
Congestion Notification.  The <code class="docutils literal notranslate"><span class="pre">Mark</span> <span class="pre">()</span></code> method is implemented in
Ipv6QueueDiscItem. It returns true if marking the packet is successful, i.e.,
it successfully sets the CE bit in the IPv6 header. The <code class="docutils literal notranslate"><span class="pre">Mark</span> <span class="pre">()</span></code> method
will return false, however, if the IPv6 header indicates the <code class="docutils literal notranslate"><span class="pre">ECN_NotECT</span></code>
codepoint.</p>
<div class="section" id="host-and-router-behaviour-in-ipv6-and-ns3">
<h3>Host and Router behaviour in IPv6 and <em>ns-3</em><a class="headerlink" href="#host-and-router-behaviour-in-ipv6-and-ns3" title="Permalink to this headline">¶</a></h3>
<p>In IPv6 there is a clear distinction between <em>routers</em> and <em>hosts</em>. As one might expect,
routers can forward packets from an interface to another interface, while hosts drop
packets not directed to them.</p>
<p>Unfortunately, forwarding is not the only thing affected by this distinction, and forwarding
itself might be fine-tuned, e.g., to forward packets incoming from an interface and drop
packets from another interface.</p>
<p>In <em>ns-3</em> a node is configured to be an <em>host</em> by default. There are two main ways to change
this behaviour:</p>
<ul class="simple">
<li><p>Using <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6InterfaceContainer</span></code> <cite>SetForwarding(uint32_t i, bool router)</cite> where <code class="docutils literal notranslate"><span class="pre">i</span></code> is the interface index in the container.</p></li>
<li><p>Changing the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6</span></code> attribute <code class="docutils literal notranslate"><span class="pre">IpForward</span></code>.</p></li>
</ul>
<p>Either one can be used during the simulation.</p>
<p>A fine-grained setup can be accomplished by using <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6Interface</span></code> <cite>SetForwarding (bool forward);</cite>
which allows to change the behaviour on a per-interface-basis.</p>
<p>Note that the node-wide configuration only serves as a convenient method to enable/disable the
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6Interface</span></code> specific setting. An Ipv6Interface added to a node
with forwarding enabled will be set to be forwarding as well.
This is really important when a node has interfaces added during the simulation.</p>
<p>According to the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6Interface</span></code> forwarding state, the following happens:</p>
<ul class="simple">
<li><p>Forwarding OFF</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>The node will NOT reply to Router Solicitation</p></li>
<li><p>The node will react to Router Advertisement</p></li>
<li><p>The node will periodically send Router Solicitation</p></li>
<li><p>Routing protocols MUST DROP packets not directed to the node</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Forwarding ON</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>The node will reply to Router Solicitation</p></li>
<li><p>The node will NOT react to Router Advertisement</p></li>
<li><p>The node will NOT send Router Solicitation</p></li>
<li><p>Routing protocols MUST forward packets</p></li>
</ul>
</div></blockquote>
<p>The behaviour is matching ip-sysctl.txt (<a class="reference external" href="http://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt">http://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt</a>)
with the difference that it’s not possible to override the behaviour using esoteric settings
(e.g., forwarding but accept router advertisements, accept_ra=2, or forwarding but send router solicitations
forwarding=2).</p>
<p>Consider carefully the implications of packet forwarding. As an example, a node will NOT send
ICMPv6 PACKET_TOO_BIG messages from an interface with forwarding off. This is completely normal,
as the Routing protocol will drop the packet before attempting to forward it.</p>
</div>
<div class="section" id="helpers">
<h3>Helpers<a class="headerlink" href="#helpers" title="Permalink to this headline">¶</a></h3>
<p>Typically the helpers used in IPv6 setup are:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::InternetStackHelper</span></code></p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6AddressHelper</span></code></p></li>
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6InterfaceContainer</span></code></p></li>
</ul>
<p>The use is almost identical to the corresponding IPv4 case, e.g.:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NodeContainer</span> <span class="n">n</span><span class="p">;</span>
<span class="n">n</span><span class="p">.</span><span class="n">Create</span> <span class="p">(</span><span class="mi">4</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span> <span class="p">(</span><span class="s">&quot;Create IPv6 Internet Stack&quot;</span><span class="p">);</span>
<span class="n">InternetStackHelper</span> <span class="n">internetv6</span><span class="p">;</span>
<span class="n">internetv6</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span> <span class="p">(</span><span class="s">&quot;Create channels.&quot;</span><span class="p">);</span>
<span class="n">CsmaHelper</span> <span class="n">csma</span><span class="p">;</span>
<span class="n">NetDeviceContainer</span> <span class="n">d</span> <span class="o">=</span> <span class="n">csma</span><span class="p">.</span><span class="n">Install</span> <span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="n">NS_LOG_INFO</span> <span class="p">(</span><span class="s">&quot;Create networks and assign IPv6 Addresses.&quot;</span><span class="p">);</span>
<span class="n">Ipv6AddressHelper</span> <span class="n">ipv6</span><span class="p">;</span>
<span class="n">ipv6</span><span class="p">.</span><span class="n">SetBase</span> <span class="p">(</span><span class="n">Ipv6Address</span> <span class="p">(</span><span class="s">&quot;2001:db8::&quot;</span><span class="p">),</span> <span class="n">Ipv6Prefix</span> <span class="p">(</span><span class="mi">64</span><span class="p">));</span>
<span class="n">Ipv6InterfaceContainer</span> <span class="n">iic</span> <span class="o">=</span> <span class="n">ipv6</span><span class="p">.</span><span class="n">Assign</span> <span class="p">(</span><span class="n">d</span><span class="p">);</span>
</pre></div>
</div>
<p>Additionally, a common task is to enable forwarding on one of the nodes and to
setup a default route toward it in the other nodes, e.g.:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">iic</span><span class="p">.</span><span class="n">SetForwarding</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="n">iic</span><span class="p">.</span><span class="n">SetDefaultRouteInAllNodes</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>This will enable forwarding on the node <em>0</em> and will setup a default route in
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6StaticRouting</span></code> on all the other nodes. Note that this
requires that Ipv6StaticRouting is present in the nodes.</p>
<p>The IPv6 routing helpers enable the user to perform specific tasks on the
particular routing algorithm and to print the routing tables.</p>
</div>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>Many classes in the <em>ns-3</em> IPv6 implementation contain attributes. The most
useful ones are:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>IpForward</cite>, boolean, default false. Globally enable or disable IP forwarding for all current and future IPv6 devices.</p></li>
<li><p><cite>MtuDiscover</cite>, boolean, default true. If disabled, every interface will have its MTU set to 1280 bytes.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6L3Protocol</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>DefaultTtl</cite>, uint8_t, default 64. The TTL value set by default on all outgoing packets generated on this node.</p></li>
<li><p><cite>SendIcmpv6Redirect</cite>, boolean, default true. Send the ICMPv6 Redirect when appropriate.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Icmpv6L4Protocol</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>DAD</cite>, boolean, default true. Always do DAD (Duplicate Address Detection) check.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::NdiscCache</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>UnresolvedQueueSize</cite>, uint32_t, default 3. Size of the queue for packets pending an NA reply.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>The IPv6 stack provides some useful trace sources:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6L3Protocol</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>Tx</cite>, Send IPv6 packet to outgoing interface.</p></li>
<li><p><cite>Rx</cite>, Receive IPv6 packet from incoming interface.</p></li>
<li><p><cite>Drop</cite>, Drop IPv6 packet.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6Extension</span></code></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>Drop</cite>, Drop IPv6 packet.</p></li>
</ul>
</div></blockquote>
<p>The latest trace source is generated when a packet contains an unknown option blocking its processing.</p>
<p>Mind that <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::NdiscCache</span></code> could drop packets as well, and they are not logged
in a trace source (yet). This might generate some confusion in the sent/received packets counters.</p>
</div>
<div class="section" id="advanced-usage">
<h3>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ipv6-maximum-transmission-unit-mtu-and-fragmentation">
<h4>IPv6 maximum transmission unit (MTU) and fragmentation<a class="headerlink" href="#ipv6-maximum-transmission-unit-mtu-and-fragmentation" title="Permalink to this headline">¶</a></h4>
<p><em>ns-3</em> NetDevices define the MTU according to the L2 simulated Device. IPv6 requires
that the minimum MTU is 1280 bytes, so all NetDevices are required to support at least
this MTU. This is the link-MTU.</p>
<p>In order to support different MTUs in a source-destination path, <em>ns-3</em> IPv6 model can
perform fragmentation.
This can be either triggered by receiving a packet bigger than the link-MTU from the L4
protocols (UDP, TCP, etc.), or by receiving an ICMPv6 PACKET_TOO_BIG message.
The model mimics RFC 1981, with the following notable exceptions:</p>
<ul class="simple">
<li><p>L4 protocols are not informed of the Path MTU change</p></li>
<li><p>TCP can not change its Segment Size according to the Path-MTU.</p></li>
</ul>
<p>Both limitations are going to be removed in due time.</p>
<p>The Path-MTU cache is currently based on the source-destination IPv6 addresses. Further
classifications (e.g., flow label) are possible but not yet implemented.</p>
<p>The Path-MTU default validity time is 10 minutes. After the cache entry expiration, the
Path-MTU information is removed and the next packet will (eventually) trigger a new ICMPv6
PACKET_TOO_BIG message.
Note that 1) this is consistent with the RFC specification and 2) L4 protocols are
responsible for retransmitting the packets.</p>
</div>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The examples for IPv6 are in the directory <code class="docutils literal notranslate"><span class="pre">examples/ipv6</span></code>. These examples focus on
the most interesting IPv6 peculiarities, such as fragmentation, redirect and so on.</p>
<p>Moreover, most TCP and UDP examples located in <code class="docutils literal notranslate"><span class="pre">examples/udp</span></code>, <code class="docutils literal notranslate"><span class="pre">examples/tcp</span></code>, etc.
have a command-line option to use IPv6 instead of IPv4.</p>
</div>
<div class="section" id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>There are just a few pitfalls to avoid while using <em>ns-3</em> IPv6.</p>
<div class="section" id="routing-loops">
<h4>Routing loops<a class="headerlink" href="#routing-loops" title="Permalink to this headline">¶</a></h4>
<p>Since the only (so far) routing scheme available for IPv6 is <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">ns3::Ipv6StaticRouting</span></code>,
default router have to be setup manually. When there are two or more routers in a network
(e.g., node A and node B), avoid using the helper function <cite>SetDefaultRouteInAllNodes</cite>
for more than one router.</p>
<p>The consequence would be to install a default route to B in A and a default route pointing to
A in B, generating a loop.</p>
</div>
<div class="section" id="global-address-leakage">
<h4>Global address leakage<a class="headerlink" href="#global-address-leakage" title="Permalink to this headline">¶</a></h4>
<p>Remember that addresses in IPv6 are <em>global</em> by definition. When using IPv6 with an emulation
<em>ns-3</em> capability, avoid at all costs address leakage toward the global Internet.
It is advisable to setup an external firewall to prevent leakage.</p>
</div>
<div class="section" id="db8-32-addresses">
<h4>2001:DB8::/32 addresses<a class="headerlink" href="#db8-32-addresses" title="Permalink to this headline">¶</a></h4>
<p>IPv6 standard (RFC 3849) defines the <code class="docutils literal notranslate"><span class="pre">2001:DB8::/32</span></code> address class for the <em>documentation</em>.
This manual uses this convention. The addresses in this class are, however, only usable in
a document, and routers should discard them.</p>
</div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>The IPv6 protocols has not yet been extensively validated against real implementations.
The actual tests involve mainly performing checks of the .pcap trace files with Wireshark,
and the results are positive.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">IPv6</a><ul>
<li><a class="reference internal" href="#ipv6-model-description">IPv6 model description</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#ipv6-addresses-assignment">IPv6 addresses assignment</a><ul>
<li><a class="reference internal" href="#manually-assigned-ipv6-addresses">Manually assigned IPv6 addresses</a><ul>
<li><a class="reference internal" href="#auto-generated-ipv6-addresses">Auto-generated IPv6 addresses</a></li>
<li><a class="reference internal" href="#random-generated-ipv6-addresses">Random-generated IPv6 addresses</a></li>
<li><a class="reference internal" href="#duplicate-address-detection-dad">Duplicate Address Detection (DAD)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#explicit-congestion-notification-ecn-bits-in-ipv6">Explicit Congestion Notification (ECN) bits in IPv6</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ipv6queuediscitem">Ipv6QueueDiscItem</a><ul>
<li><a class="reference internal" href="#host-and-router-behaviour-in-ipv6-and-ns3">Host and Router behaviour in IPv6 and <em>ns-3</em></a></li>
<li><a class="reference internal" href="#helpers">Helpers</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
<li><a class="reference internal" href="#advanced-usage">Advanced Usage</a><ul>
<li><a class="reference internal" href="#ipv6-maximum-transmission-unit-mtu-and-fragmentation">IPv6 maximum transmission unit (MTU) and fragmentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#routing-loops">Routing loops</a></li>
<li><a class="reference internal" href="#global-address-leakage">Global address leakage</a></li>
<li><a class="reference internal" href="#db8-32-addresses">2001:DB8::/32 addresses</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#validation">Validation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ipv4.html"
                        title="previous chapter">IPv4</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="routing-overview.html"
                        title="next chapter">Routing overview</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ipv6.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="routing-overview.html" title="Routing overview"
             >next</a> |</li>
        <li class="right" >
          <a href="ipv4.html" title="IPv4"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="internet-models.html" >Internet Models (IP, TCP, Routing, UDP, Internet Applications)</a><span class="navelem">&nbsp;</span></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2006-2019.
      Last updated on Apr 29, 2020 17:37.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.
    </div>
  </body>
</html>