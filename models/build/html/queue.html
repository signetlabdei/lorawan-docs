
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>24.6. Queues &#8212; Model Library</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/default.css?v=bb97339c" />
    <script src="_static/documentation_options.js?v=316584e3"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="24.7. Queue limits" href="queue-limits.html" />
    <link rel="prev" title="24.5. Simple NetDevice" href="simple.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico"
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>


  </head><body>
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" width="100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo">
              <a id="ns3_home1"
                 href="http://www.nsnam.org/">
                 <img alt="ns-3 Logo" style="background-color: unset;"
                      src="_static/ns-3-inverted-notext-small.png"/>
              </a>
            </td>
            <td id="projecttext">
              <div id="projectbrief">A Discrete-Event Network Simulator</div>
              <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
            </td>

            <td id="ns3-menu">
              <div class="menu">
                <ul >
                  <li style="background-image:none">
                    <a id="ns3_home2"
                         href="http://www.nsnam.org/"
                         >&nbsp;&nbsp;Home</a>
                  </li>
                  <li><span
                        onmouseover="mopen('mTuts')"
                        onmouseout="mclosetime()"
                          >Tutorials &nbsp;&#x25BC;</span>
                      <div id="mTuts"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_tut"
                           href="/docs/tutorial/html/index.html"
                            >English</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDocs')"
                        onmouseout="mclosetime()"
                          >Documentation &nbsp;&#x25BC;</span>
                      <div id="mDocs"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_ins"
                           href="/docs/installation/html/index.html"
                           >Installation</a><br/>
                        <a id="ns3_man"
                           href="/docs/manual/html/index.html"
                           >Manual</a><br/>
                        <a id="ns3_mod"
                           href="/docs/models/html/index.html"
                           >Models</a><br/>
                        <a id="ns3_con"
                           href="/docs/contributing/html/index.html"
                           >Contributing</a><br/>
                        <a id="ns3_wiki"
                           href="http://www.nsnam.org/wiki"
                           >Wiki</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDev')"
                        onmouseout="mclosetime()"
                          >Development &nbsp;&#x25BC;</span>
                      <div id="mDev"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_api"
                           href="/docs/doxygen/html/index.html"
                           >API Docs</a><br/>
                        <a id="ns3_bugs"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/issues"
                           >Issue Tracker</a><br/>
                        <a id="ns3_merge"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests"
                           >Merge Requests</a><br/>
                      </div>
                  </li>
                </ul>
              </div>
            </td>

            <td id="projectsection">
              <span style="margin-right:10px">Models</span>
            </td>
          </tr>
        </tbody>
      </table>
      <script  type="text/javascript">ns3_write_links()</script>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="queue-limits.html" title="24.7. Queue limits"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="simple.html" title="24.5. Simple NetDevice"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="network.html" accesskey="U"><span class="section-number">24. </span>Network Module</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">24.6. </span>Queues</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="queues">
<h1><span class="section-number">24.6. </span>Queues<a class="headerlink" href="#queues" title="Link to this heading">¶</a></h1>
<p>This section documents the queue object, which is typically used by NetDevices
and QueueDiscs to store packets.</p>
<p>Packets stored in a queue can be managed according to different policies.
Currently, only the DropTail policy is available.</p>
<section id="model-description">
<h2><span class="section-number">24.6.1. </span>Model Description<a class="headerlink" href="#model-description" title="Link to this heading">¶</a></h2>
<p>The source code for the new module lives in the directory <code class="docutils literal notranslate"><span class="pre">src/network/utils</span></code>.</p>
<p>ns3::Queue has been redesigned as a template class object to allow us to
instantiate queues storing different types of items. The unique template
type parameter specifies the type of items stored in the queue.
The only requirement on the item type is that it must provide a GetSize ()
method which returns the size of the packet included in the item.
Currently, queue items can be objects of the following classes:</p>
<ul class="simple">
<li><p>Packet</p></li>
<li><p>QueueItem and subclasses (e.g., QueueDiscItem)</p></li>
<li><p>WifiMacQueueItem</p></li>
</ul>
<p>The internal queues of the queue discs are of type Queue&lt;QueueDiscItem&gt;
(an alias of which being InternalQueue). A number of network devices
(SimpleNetDevice, PointToPointNetDevice, CsmaNetDevice) use a Queue&lt;Packet&gt;
to store packets to be transmitted. WifiNetDevices use instead queues of
type WifiMacQueue, which is a subclass of Queue storing objects of
type WifiMacQueueItem. Other devices, such as WiMax and LTE, use specialized
queues.</p>
<section id="design">
<h3><span class="section-number">24.6.1.1. </span>Design<a class="headerlink" href="#design" title="Link to this heading">¶</a></h3>
<p>The Queue class derives from the QueueBase class, which is a non-template
class providing all the methods that are independent of the type of the items
stored in the queue. The Queue class provides instead all the operations that
depend on the item type, such as enqueue, dequeue, peek and remove. The Queue
class also provides the ability to trace certain queue operations such as
enqueuing, dequeuing, and dropping.</p>
<p>Queue is an abstract base class and is subclassed for specific scheduling and
drop policies. Subclasses need to define the following public methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">Enqueue</span> <span class="pre">(Ptr&lt;Item&gt;</span> <span class="pre">item)</span></code>:  Enqueue a packet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ptr&lt;Item&gt;</span> <span class="pre">Dequeue</span> <span class="pre">()</span></code>:  Dequeue a packet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ptr&lt;Item&gt;</span> <span class="pre">Remove</span> <span class="pre">()</span></code>:  Remove a packet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ptr&lt;const</span> <span class="pre">Item&gt;</span> <span class="pre">Peek</span> <span class="pre">()</span></code>:  Peek a packet</p></li>
</ul>
<p>The Enqueue method does not allow to store a packet if the queue capacity is exceeded.
Subclasses may also define specialized public methods. For instance, the
WifiMacQueue class provides a method to dequeue a packet based on its tid
and MAC address.</p>
<p>There are five trace sources that may be hooked:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Enqueue</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dequeue</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Drop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DropBeforeEnqueue</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DropAfterDequeue</span></code></p></li>
</ul>
<p>Also, the QueueBase class defines two additional trace sources:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PacketsInQueue</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BytesInQueue</span></code></p></li>
</ul>
<section id="droptail">
<h4><span class="section-number">24.6.1.1.1. </span>DropTail<a class="headerlink" href="#droptail" title="Link to this heading">¶</a></h4>
<p>This is a basic first-in-first-out (FIFO) queue that performs a tail drop
when the queue is full.</p>
<p>The DropTailQueue class defines one attribute:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MaxSize</span></code>: the maximum queue size</p></li>
</ul>
</section>
</section>
</section>
<section id="usage">
<h2><span class="section-number">24.6.2. </span>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<section id="helpers">
<h3><span class="section-number">24.6.2.1. </span>Helpers<a class="headerlink" href="#helpers" title="Link to this heading">¶</a></h3>
<p>A typical usage pattern is to create a device helper and to configure
the queue type and attributes from the helper, such as this example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PointToPointHelper</span><span class="w"> </span><span class="n">p2p</span><span class="p">;</span>

<span class="n">p2p</span><span class="p">.</span><span class="n">SetQueue</span><span class="p">(</span><span class="s">&quot;ns3::DropTailQueue&quot;</span><span class="p">);</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">&quot;DataRate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="s">&quot;10Mbps&quot;</span><span class="p">));</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">&quot;Delay&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="s">&quot;2ms&quot;</span><span class="p">));</span>
<span class="n">NetDeviceContainer</span><span class="w"> </span><span class="n">devn0n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2p</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">n0n2</span><span class="p">);</span>

<span class="n">p2p</span><span class="p">.</span><span class="n">SetQueue</span><span class="p">(</span><span class="s">&quot;ns3::DropTailQueue&quot;</span><span class="p">);</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">&quot;DataRate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="s">&quot;10Mbps&quot;</span><span class="p">));</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">&quot;Delay&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="s">&quot;3ms&quot;</span><span class="p">));</span>
<span class="n">NetDeviceContainer</span><span class="w"> </span><span class="n">devn1n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2p</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">n1n2</span><span class="p">);</span>

<span class="n">p2p</span><span class="p">.</span><span class="n">SetQueue</span><span class="p">(</span><span class="s">&quot;ns3::DropTailQueue&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="s">&quot;MaxSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="s">&quot;50p&quot;</span><span class="p">));</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">&quot;DataRate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="n">linkDataRate</span><span class="p">));</span>
<span class="n">p2p</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">&quot;Delay&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">StringValue</span><span class="p">(</span><span class="n">linkDelay</span><span class="p">));</span>
<span class="n">NetDeviceContainer</span><span class="w"> </span><span class="n">devn2n3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2p</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">n2n3</span><span class="p">);</span>
</pre></div>
</div>
<p>Please note that the SetQueue method of the PointToPointHelper class allows
to specify “ns3::DropTailQueue” instead of “ns3::DropTailQueue&lt;Packet&gt;”. The
same holds for CsmaHelper, SimpleNetDeviceHelper and TrafficControlHelper.</p>
</section>
<section id="output">
<h3><span class="section-number">24.6.2.2. </span>Output<a class="headerlink" href="#output" title="Link to this heading">¶</a></h3>
<p>The ns-3 ascii trace helpers used by many of the NetDevices will hook
the Enqueue, Dequeue, and Drop traces of these queues and print out
trace statements, such as the following from <code class="docutils literal notranslate"><span class="pre">examples/udp/udp-echo.cc</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+ 2 /NodeList/0/DeviceList/1/$ns3::CsmaNetDevice/TxQueue/Enqueue ns3::EthernetHeader
( length/type=0x806, source=00:00:00:00:00:01, destination=ff:ff:ff:ff:ff:ff)
ns3::ArpHeader (request source mac: 00-06-00:00:00:00:00:01 source ipv4: 10.1.1.1
dest ipv4: 10.1.1.2) Payload (size=18) ns3::EthernetTrailer (fcs=0)
- 2 /NodeList/0/DeviceList/1/$ns3::CsmaNetDevice/TxQueue/Dequeue ns3::EthernetHeader
( length/type=0x806, source=00:00:00:00:00:01, destination=ff:ff:ff:ff:ff:ff)
ns3::ArpHeader (request source mac: 00-06-00:00:00:00:00:01 source ipv4: 10.1.1.1
dest ipv4: 10.1.1.2) Payload (size=18) ns3::EthernetTrailer (fcs=0)
</pre></div>
</div>
<p>which shows an enqueue “+” and dequeue “-” event at time 2 seconds.</p>
<p>Users are, of course, free to define and hook their own trace sinks to
these trace sources.</p>
</section>
<section id="examples">
<h3><span class="section-number">24.6.2.3. </span>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>The drop-tail queue is used in several examples, such as
<code class="docutils literal notranslate"><span class="pre">examples/udp/udp-echo.cc</span></code>.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">24.6. Queues</a><ul>
<li><a class="reference internal" href="#model-description">24.6.1. Model Description</a><ul>
<li><a class="reference internal" href="#design">24.6.1.1. Design</a><ul>
<li><a class="reference internal" href="#droptail">24.6.1.1.1. DropTail</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage">24.6.2. Usage</a><ul>
<li><a class="reference internal" href="#helpers">24.6.2.1. Helpers</a></li>
<li><a class="reference internal" href="#output">24.6.2.2. Output</a></li>
<li><a class="reference internal" href="#examples">24.6.2.3. Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="simple.html"
                          title="previous chapter"><span class="section-number">24.5. </span>Simple NetDevice</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="queue-limits.html"
                          title="next chapter"><span class="section-number">24.7. </span>Queue limits</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/queue.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="queue-limits.html" title="24.7. Queue limits"
             >next</a> |</li>
        <li class="right" >
          <a href="simple.html" title="24.5. Simple NetDevice"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Models</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="network.html" ><span class="section-number">24. </span>Network Module</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">24.6. </span>Queues</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2006-2019.
      Last updated on Nov 09, 2023 12:57.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>