
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.4.5. Aggregators &#8212; Manual</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/default.css?v=bb97339c" />
    <script src="_static/documentation_options.js?v=951d00fa"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.4.6. Adaptors" href="adaptor.html" />
    <link rel="prev" title="3.4.4. Collectors" href="collector.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico"
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>


  </head><body>
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" width="100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo">
              <a id="ns3_home1"
                 href="http://www.nsnam.org/">
                 <img alt="ns-3 Logo" style="background-color: unset;"
                      src="_static/ns-3-inverted-notext-small.png"/>
              </a>
            </td>
            <td id="projecttext">
              <div id="projectbrief">A Discrete-Event Network Simulator</div>
              <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
            </td>

            <td id="ns3-menu">
              <div class="menu">
                <ul >
                  <li style="background-image:none">
                    <a id="ns3_home2"
                         href="http://www.nsnam.org/"
                         >&nbsp;&nbsp;Home</a>
                  </li>
                  <li><span
                        onmouseover="mopen('mTuts')"
                        onmouseout="mclosetime()"
                          >Tutorials &nbsp;&#x25BC;</span>
                      <div id="mTuts"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_tut"
                           href="/docs/tutorial/html/index.html"
                            >English</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDocs')"
                        onmouseout="mclosetime()"
                          >Documentation &nbsp;&#x25BC;</span>
                      <div id="mDocs"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_ins"
                           href="/docs/installation/html/index.html"
                           >Installation</a><br/>
                        <a id="ns3_man"
                           href="/docs/manual/html/index.html"
                           >Manual</a><br/>
                        <a id="ns3_mod"
                           href="/docs/models/html/index.html"
                           >Models</a><br/>
                        <a id="ns3_con"
                           href="/docs/contributing/html/index.html"
                           >Contributing</a><br/>
                        <a id="ns3_wiki"
                           href="http://www.nsnam.org/wiki"
                           >Wiki</a><br/>
                      </div>
                  </li>
                  <li><span
                        onmouseover="mopen('mDev')"
                        onmouseout="mclosetime()"
                          >Development &nbsp;&#x25BC;</span>
                      <div id="mDev"
                          onmouseover="mcancelclosetime()"
                          onmouseout="mclosetime()">
                        <a id="ns3_api"
                           href="/docs/doxygen/html/index.html"
                           >API Docs</a><br/>
                        <a id="ns3_bugs"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/issues"
                           >Issue Tracker</a><br/>
                        <a id="ns3_merge"
                         href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests"
                           >Merge Requests</a><br/>
                      </div>
                  </li>
                </ul>
              </div>
            </td>

            <td id="projectsection">
              <span style="margin-right:10px">Manual</span>
            </td>
          </tr>
        </tbody>
      </table>
      <script  type="text/javascript">ns3_write_links()</script>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="adaptor.html" title="3.4.6. Adaptors"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="collector.html" title="3.4.4. Collectors"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Manual</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="features.html" ><span class="section-number">3. </span>Additional Tools</a><span class="navelem">&nbsp;</span></li>
          <li class="nav-item nav-item-2"><a href="data-collection.html" accesskey="U"><span class="section-number">3.4. </span>Data Collection</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.4.5. </span>Aggregators</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="aggregators">
<h1><span class="section-number">3.4.5. </span>Aggregators<a class="headerlink" href="#aggregators" title="Link to this heading">¶</a></h1>
<p>This section details the functionalities provided by the Aggregator
class to an <em>ns-3</em> simulation. This section is meant for users
interested in developing simulations with the <em>ns-3</em> tools and using
the Data Collection Framework, of which the Aggregator class is a
part, to generate data output with their simulation’s results.</p>
<section id="aggregator-overview">
<h2><span class="section-number">3.4.5.1. </span>Aggregator Overview<a class="headerlink" href="#aggregator-overview" title="Link to this heading">¶</a></h2>
<p>An Aggregator object is supposed to be hooked to one or more trace
sources in order to receive input. Aggregators are the end point of
the data collected by the network of Probes and Collectors during the
simulation.  It is the Aggregator’s job to take these values and
transform them into their final output format such as plain text
files, spreadsheet files, plots, or databases.</p>
<p>Typically, an aggregator is connected to one or more Collectors.  In
this manner, whenever the Collectors’ trace sources export new values,
the Aggregator can process the value so that it can be used in the
final output format where the data values will reside after the
simulation.</p>
<p>Note the following about Aggregators:</p>
<ul class="simple">
<li><p>Aggregators may be dynamically turned on and off during the
simulation with calls to <code class="docutils literal notranslate"><span class="pre">Enable()</span></code> and <code class="docutils literal notranslate"><span class="pre">Disable()</span></code>.  For
example, the aggregating of data may be turned off during the
simulation warmup phase, which means those values won’t be included
in the final output medium.</p></li>
<li><p>Aggregators receive data from Collectors via callbacks. When a
Collector is associated to an aggregator, a call to TraceConnect is
made to establish the Aggregator’s trace sink method as a callback.</p></li>
</ul>
<p>To date, two Aggregators have been implemented:</p>
<ul class="simple">
<li><p>GnuplotAggregator</p></li>
<li><p>FileAggregator</p></li>
</ul>
</section>
<section id="gnuplotaggregator">
<h2><span class="section-number">3.4.5.2. </span>GnuplotAggregator<a class="headerlink" href="#gnuplotaggregator" title="Link to this heading">¶</a></h2>
<p>The GnuplotAggregator produces output files used to make gnuplots.</p>
<p>The GnuplotAggregator will create 3 different files at the end of the
simulation:</p>
<ul class="simple">
<li><p>A space separated gnuplot data file</p></li>
<li><p>A gnuplot control file</p></li>
<li><p>A shell script to generate the gnuplot</p></li>
</ul>
<section id="creation">
<h3><span class="section-number">3.4.5.2.1. </span>Creation<a class="headerlink" href="#creation" title="Link to this heading">¶</a></h3>
<p>An object of type GnuplotAggregator will be created here to show what needs
to be done.</p>
<p>One declares a GnuplotAggregator in dynamic memory by using the smart
pointer class (Ptr&lt;T&gt;). To create a GnuplotAggregator in dynamic
memory with smart pointers, one just needs to call the <em>ns-3</em> method
<code class="docutils literal notranslate"><span class="pre">CreateObject()</span></code>.  The following code from
<code class="docutils literal notranslate"><span class="pre">src/stats/examples/gnuplot-aggregator-example.cc</span></code> shows
how to do this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">string</span><span class="w"> </span><span class="n">fileNameWithoutExtension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;gnuplot-aggregator&quot;</span><span class="p">;</span>

<span class="c1">// Create an aggregator.</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">GnuplotAggregator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aggregator</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">GnuplotAggregator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fileNameWithoutExtension</span><span class="p">);</span>
</pre></div>
</div>
<p>The first argument for the constructor, fileNameWithoutExtension, is
the name of the gnuplot related files to write with no extension.
This GnuplotAggregator will create a space separated gnuplot data file
named “gnuplot-aggregator.dat”, a gnuplot control file named
“gnuplot-aggregator.plt”, and a shell script to generate the gnuplot
named + “gnuplot-aggregator.sh”.</p>
<p>The gnuplot that is created can have its key in 4 different locations:</p>
<ul class="simple">
<li><p>No key</p></li>
<li><p>Key inside the plot (the default)</p></li>
<li><p>Key above the plot</p></li>
<li><p>Key below the plot</p></li>
</ul>
<p>The following gnuplot key location enum values are allowed to specify the key’s position:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">KeyLocation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NO_KEY</span><span class="p">,</span>
<span class="w">  </span><span class="n">KEY_INSIDE</span><span class="p">,</span>
<span class="w">  </span><span class="n">KEY_ABOVE</span><span class="p">,</span>
<span class="w">  </span><span class="n">KEY_BELOW</span>
<span class="p">};</span>
</pre></div>
</div>
<p>If it was desired to have the key below rather than the default position of inside, then you could do the following.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">SetKeyLocation</span><span class="p">(</span><span class="n">GnuplotAggregator</span><span class="o">::</span><span class="n">KEY_BELOW</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="examples">
<h3><span class="section-number">3.4.5.2.2. </span>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>One example will be discussed in detail here:</p>
<ul class="simple">
<li><p>Gnuplot Aggregator Example</p></li>
</ul>
<section id="gnuplot-aggregator-example">
<h4><span class="section-number">3.4.5.2.2.1. </span>Gnuplot Aggregator Example<a class="headerlink" href="#gnuplot-aggregator-example" title="Link to this heading">¶</a></h4>
<p>An example that exercises the GnuplotAggregator can be found in
<code class="docutils literal notranslate"><span class="pre">src/stats/examples/gnuplot-aggregator-example.cc</span></code>.</p>
<p>The following 2-D gnuplot was created using the example.</p>
<figure class="align-default" id="id3">
<span id="gnuplot-aggregator"></span><img alt="_images/gnuplot-aggregator.png" src="_images/gnuplot-aggregator.png" />
<figcaption>
<p><span class="caption-text">2-D Gnuplot Created by gnuplot-aggregator-example.cc Example.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>This code from the example shows how to construct the
GnuplotAggregator as was discussed above.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">Create2dPlot</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileNameWithoutExtension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;gnuplot-aggregator&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">plotTitle</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Gnuplot Aggregator Plot&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">plotXAxisHeading</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Time(seconds)&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">plotYAxisHeading</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Double Values&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">plotDatasetLabel</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Data Values&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">datasetContext</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Dataset/Context/String&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create an aggregator.</span>
<span class="w">  </span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">GnuplotAggregator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aggregator</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">GnuplotAggregator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fileNameWithoutExtension</span><span class="p">);</span>
</pre></div>
</div>
<p>Various GnuplotAggregator attributes are set including the 2-D dataset
that will be plotted.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set the aggregator&#39;s properties.</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">SetTerminal</span><span class="p">(</span><span class="s">&quot;png&quot;</span><span class="p">);</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">plotTitle</span><span class="p">);</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">SetLegend</span><span class="p">(</span><span class="n">plotXAxisHeading</span><span class="p">,</span><span class="w"> </span><span class="n">plotYAxisHeading</span><span class="p">);</span>

<span class="c1">// Add a data set to the aggregator.</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Add2dDataset</span><span class="p">(</span><span class="n">datasetContext</span><span class="p">,</span><span class="w"> </span><span class="n">plotDatasetLabel</span><span class="p">);</span>

<span class="c1">// aggregator must be turned on</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Enable</span><span class="p">();</span>
</pre></div>
</div>
<p>Next, the 2-D values are calculated, and each one is individually
written to the GnuplotAggregator using the <code class="docutils literal notranslate"><span class="pre">Write2d()</span></code> function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create the 2-D dataset.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">+</span><span class="mf">5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Calculate the 2-D curve</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="c1">//                   2</span>
<span class="w">      </span><span class="c1">//     value  =  time   .</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// Add this point to the plot.</span>
<span class="w">      </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Write2d</span><span class="p">(</span><span class="n">datasetContext</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Disable logging of data for the aggregator.</span>
<span class="w">  </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Disable</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="fileaggregator">
<h2><span class="section-number">3.4.5.3. </span>FileAggregator<a class="headerlink" href="#fileaggregator" title="Link to this heading">¶</a></h2>
<p>The FileAggregator sends the values it receives to a file.</p>
<p>The FileAggregator can create 4 different types of files:</p>
<ul class="simple">
<li><p>Formatted</p></li>
<li><p>Space separated (the default)</p></li>
<li><p>Comma separated</p></li>
<li><p>Tab separated</p></li>
</ul>
<p>Formatted files use C-style format strings and the sprintf() function
to print their values in the file being written.</p>
<section id="id1">
<h3><span class="section-number">3.4.5.3.1. </span>Creation<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>An object of type FileAggregator will be created here to show what needs
to be done.</p>
<p>One declares a FileAggregator in dynamic memory by using the smart
pointer class (Ptr&lt;T&gt;). To create a FileAggregator in dynamic memory
with smart pointers, one just needs to call the <em>ns-3</em> method
CreateObject.  The following code from
<code class="docutils literal notranslate"><span class="pre">src/stats/examples/file-aggregator-example.cc</span></code> shows how
to do this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">string</span><span class="w"> </span><span class="n">fileName</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;file-aggregator-formatted-values.txt&quot;</span><span class="p">;</span>

<span class="c1">// Create an aggregator that will have formatted values.</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aggregator</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">FileAggregator</span><span class="o">::</span><span class="n">FORMATTED</span><span class="p">);</span>
</pre></div>
</div>
<p>The first argument for the constructor, filename, is the name of the
file to write; the second argument, fileType, is type of file to
write. This FileAggregator will create a file named
“file-aggregator-formatted-values.txt” with its values printed as
specified by fileType, i.e., formatted in this case.</p>
<p>The following file type enum values are allowed:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">FileType</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">FORMATTED</span><span class="p">,</span>
<span class="w">  </span><span class="n">SPACE_SEPARATED</span><span class="p">,</span>
<span class="w">  </span><span class="n">COMMA_SEPARATED</span><span class="p">,</span>
<span class="w">  </span><span class="n">TAB_SEPARATED</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">3.4.5.3.2. </span>Examples<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>One example will be discussed in detail here:</p>
<ul class="simple">
<li><p>File Aggregator Example</p></li>
</ul>
<section id="file-aggregator-example">
<h4><span class="section-number">3.4.5.3.2.1. </span>File Aggregator Example<a class="headerlink" href="#file-aggregator-example" title="Link to this heading">¶</a></h4>
<p>An example that exercises the FileAggregator can be found in
<code class="docutils literal notranslate"><span class="pre">src/stats/examples/file-aggregator-example.cc</span></code>.</p>
<p>The following text file with 2 columns of values separated by commas
was created using the example.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="mi">-5</span><span class="p">,</span><span class="mi">25</span>
<span class="mi">-4</span><span class="p">,</span><span class="mi">16</span>
<span class="mi">-3</span><span class="p">,</span><span class="mi">9</span>
<span class="mi">-2</span><span class="p">,</span><span class="mi">4</span>
<span class="mi">-1</span><span class="p">,</span><span class="mi">1</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">4</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">9</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">16</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">25</span>
</pre></div>
</div>
<p>This code from the example shows how to construct the
FileAggregator as was discussed above.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">CreateCommaSeparatedFile</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileName</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;file-aggregator-comma-separated.txt&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">datasetContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Dataset/Context/String&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create an aggregator.</span>
<span class="w">  </span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aggregator</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">FileAggregator</span><span class="o">::</span><span class="n">COMMA_SEPARATED</span><span class="p">);</span>
</pre></div>
</div>
<p>FileAggregator attributes are set.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// aggregator must be turned on</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Enable</span><span class="p">();</span>
</pre></div>
</div>
<p>Next, the 2-D values are calculated, and each one is individually
written to the FileAggregator using the <code class="docutils literal notranslate"><span class="pre">Write2d()</span></code> function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create the 2-D dataset.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">+</span><span class="mf">5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Calculate the 2-D curve</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="c1">//                   2</span>
<span class="w">      </span><span class="c1">//     value  =  time   .</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// Add this point to the plot.</span>
<span class="w">      </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Write2d</span><span class="p">(</span><span class="n">datasetContext</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Disable logging of data for the aggregator.</span>
<span class="w">  </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Disable</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following text file with 2 columns of formatted values was also
created using the example.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.000e+00</span><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.000e+00</span><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.000e+00</span><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.000e+00</span><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.000e+00</span><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span>
<span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.000e+00</span><span class="w">   </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
</pre></div>
</div>
<p>This code from the example shows how to construct the
FileAggregator as was discussed above.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">CreateFormattedFile</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileName</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;file-aggregator-formatted-values.txt&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">datasetContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Dataset/Context/String&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create an aggregator that will have formatted values.</span>
<span class="w">  </span><span class="n">Ptr</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aggregator</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">CreateObject</span><span class="o">&lt;</span><span class="n">FileAggregator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">FileAggregator</span><span class="o">::</span><span class="n">FORMATTED</span><span class="p">);</span>
</pre></div>
</div>
<p>FileAggregator attributes are set, including the C-style format string
to use.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set the format for the values.</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Set2dFormat</span><span class="p">(</span><span class="s">&quot;Time = %.3e</span><span class="se">\t</span><span class="s">Value = %.0f&quot;</span><span class="p">);</span>

<span class="c1">// aggregator must be turned on</span>
<span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Enable</span><span class="p">();</span>
</pre></div>
</div>
<p>Next, the 2-D values are calculated, and each one is individually
written to the FileAggregator using the <code class="docutils literal notranslate"><span class="pre">Write2d()</span></code> function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Create the 2-D dataset.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">+</span><span class="mf">5.0</span><span class="p">;</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Calculate the 2-D curve</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="c1">//                   2</span>
<span class="w">      </span><span class="c1">//     value  =  time   .</span>
<span class="w">      </span><span class="c1">//</span>
<span class="w">      </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">time</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// Add this point to the plot.</span>
<span class="w">      </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Write2d</span><span class="p">(</span><span class="n">datasetContext</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Disable logging of data for the aggregator.</span>
<span class="w">  </span><span class="n">aggregator</span><span class="o">-&gt;</span><span class="n">Disable</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.4.5. Aggregators</a><ul>
<li><a class="reference internal" href="#aggregator-overview">3.4.5.1. Aggregator Overview</a></li>
<li><a class="reference internal" href="#gnuplotaggregator">3.4.5.2. GnuplotAggregator</a><ul>
<li><a class="reference internal" href="#creation">3.4.5.2.1. Creation</a></li>
<li><a class="reference internal" href="#examples">3.4.5.2.2. Examples</a><ul>
<li><a class="reference internal" href="#gnuplot-aggregator-example">3.4.5.2.2.1. Gnuplot Aggregator Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fileaggregator">3.4.5.3. FileAggregator</a><ul>
<li><a class="reference internal" href="#id1">3.4.5.3.1. Creation</a></li>
<li><a class="reference internal" href="#id2">3.4.5.3.2. Examples</a><ul>
<li><a class="reference internal" href="#file-aggregator-example">3.4.5.3.2.1. File Aggregator Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="collector.html"
                          title="previous chapter"><span class="section-number">3.4.4. </span>Collectors</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="adaptor.html"
                          title="next chapter"><span class="section-number">3.4.6. </span>Adaptors</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/aggregator.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="adaptor.html" title="3.4.6. Adaptors"
             >next</a> |</li>
        <li class="right" >
          <a href="collector.html" title="3.4.4. Collectors"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Manual</a><span class="navelem">&nbsp;</span></li>

          <li class="nav-item nav-item-1"><a href="features.html" ><span class="section-number">3. </span>Additional Tools</a><span class="navelem">&nbsp;</span></li>
          <li class="nav-item nav-item-2"><a href="data-collection.html" ><span class="section-number">3.4. </span>Data Collection</a><span class="navelem">&nbsp;</span></li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.4.5. </span>Aggregators</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2006-2019, ns-3 project.
      Last updated on Mar 20, 2024 17:55.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>