

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Using Python to Run ns-3 &#8212; Manual</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tests" href="tests.html" />
    <link rel="prev" title="Making Plots using the Gnuplot Class" href="gnuplot.html" />
  <link rel="stylesheet" type="text/css"
    href="_static/ns3_stylesheet.css" />
    <link rel="icon" type="image/ico" 
      href="_static/favicon.ico" />

  <script type="text/javascript" src="_static/drop-down-menu.js"></script>
  <script type="text/javascript" src="_static/ns3_version.js"></script>
  <script type="text/javascript">var ns3_builder="html";</script>
  <script type="text/javascript" src="_static/ns3_links.js"></script>
      

  </head><body>
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0" width="100%">
      <tbody>
	<tr style="height: 56px;">
	  <td id="projectlogo">
	    <a id="ns3_home1"
	       href="http://www.nsnam.org/">
	       <img alt="ns-3 Logo"
		    src="_static/ns-3-inverted-notext-small.png"/>
	    </a>
	  </td>
	  <td id="projecttext">
	    <div id="projectbrief">A Discrete-Event Network Simulator</div>
	      <span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
	  </td>
	      
	  <td id="ns3-menu">
	    <div class="menu">
	      <ul >
	        <li><a id="ns3_home2"
		       href="http://www.nsnam.org/"
		       >&nbsp;&nbsp;Home</a>
	        </li>
	        <li><span
		      onmouseover="mopen('mTuts')" 
		      onmouseout="mclosetime()"
			>Tutorials &nbsp;&#x25BC;</span>
		    <div id="mTuts" 
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_tut"
			 href="/docs/tutorial/html/index.html"
			  >English</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDocs')" 
		      onmouseout="mclosetime()"
			>Docs &nbsp;&nbsp;&nbsp;&#x25BC;</span>
		    <div id="mDocs"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_wiki"
			 href="http://www.nsnam.org/wiki"
			 >Wiki</a><br/>
		      <a id="ns3_man"
			 href="/docs/manual/html/index.html"
			 >Manual</a><br/>
		      <a id="ns3_mod"
			 href="/docs/models/html/index.html"
			 >Models</a><br/>
	        </li>
	        <li><span
		      onmouseover="mopen('mDev')" 
		      onmouseout="mclosetime()"
			>Develop &#x25BC;</span>
		    <div id="mDev"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
		      <a id="ns3_api"
			 href="/docs/doxygen/html/index.html"
			 >API</a><br/>
		      <a id="ns3_bugs"
		       href="http://www.nsnam.org/bugzilla/">Bugs</a>
	        </li>
	      </ul>
	    </div>
	  </td>
	  <td id="projectsection">
	    <span style="margin-right:10px">Manual</span>
	  </td>
	</tr>
      </tbody>
    </table>
    <script  type="text/javascript">ns3_write_links()</script>
  </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tests.html" title="Tests"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gnuplot.html" title="Making Plots using the Gnuplot Class"
             accesskey="P">previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Manual</a><span class="navelem">&nbsp;</span></li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-python-to-run-ns3">
<h1>Using Python to Run <em>ns-3</em><a class="headerlink" href="#using-python-to-run-ns3" title="Permalink to this headline">¶</a></h1>
<p>Python bindings allow the C++ code in <em>ns-3</em> to be called from Python.</p>
<p>This chapter shows you how to create a Python script that can run <em>ns-3</em> and also the process of creating Python bindings for a C++ <em>ns-3</em> module.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Python bindings provide support for importing <em>ns-3</em> model libraries as Python
modules.  Coverage of most of the <em>ns-3</em> C++ API is provided.  The intent
has been to allow the programmer to write complete simulation scripts in
Python, to allow integration of <em>ns-3</em> with other Python tools and workflows.
The intent is not to provide a different language choice to author new
<em>ns-3</em> models implemented in Python.</p>
<p>Python bindings for <em>ns-3</em> use a tool called PyBindGen (<a class="reference external" href="https://github.com/gjcarneiro/pybindgen">https://github.com/gjcarneiro/pybindgen</a>) to create Python modules from the C++ libraries built by
Waf.  The Python bindings that PyBindGen uses are maintained in a
<code class="docutils literal notranslate"><span class="pre">bindings</span></code> directory in each module, and must be maintained to match the
C++ API of that ns-3 module.  If the C++ API changes, the Python bindings file
must either be modified by hand accordingly, or the bindings must be
regenerated by an automated scanning process.</p>
<p>If a user is not interested in Python, he or she may disable the use of
Python bindings at Waf configure time.  In this case, changes to the C++
API of a provided module will not cause the module to fail to compile.</p>
<p>The process for automatically generating Python bindings relies on a toolchain
involving a development installation of the Clang compiler, a program called
CastXML (<a class="reference external" href="https://github.com/CastXML/CastXML">https://github.com/CastXML/CastXML</a>), and a program called
pygccxml (<a class="reference external" href="https://github.com/gccxml/pygccxml">https://github.com/gccxml/pygccxml</a>).  The toolchain can be installed
using the ns-3 <code class="docutils literal notranslate"><span class="pre">bake</span></code> build tool.</p>
</div>
<div class="section" id="an-example-python-script-that-runs-ns3">
<h2>An Example Python Script that Runs <em>ns-3</em><a class="headerlink" href="#an-example-python-script-that-runs-ns3" title="Permalink to this headline">¶</a></h2>
<p>Here is some example code that is written in Python and that runs <em>ns-3</em>, which is written in C++.  This Python example can be found in <code class="docutils literal notranslate"><span class="pre">examples/tutorial/first.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ns.applications</span>
<span class="kn">import</span> <span class="nn">ns.core</span>
<span class="kn">import</span> <span class="nn">ns.internet</span>
<span class="kn">import</span> <span class="nn">ns.network</span>
<span class="kn">import</span> <span class="nn">ns.point_to_point</span>

<span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">LogComponentEnable</span><span class="p">(</span><span class="s2">&quot;UdpEchoClientApplication&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">LOG_LEVEL_INFO</span><span class="p">)</span>
<span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">LogComponentEnable</span><span class="p">(</span><span class="s2">&quot;UdpEchoServerApplication&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">LOG_LEVEL_INFO</span><span class="p">)</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">NodeContainer</span><span class="p">()</span>
<span class="n">nodes</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">pointToPoint</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">point_to_point</span><span class="o">.</span><span class="n">PointToPointHelper</span><span class="p">()</span>
<span class="n">pointToPoint</span><span class="o">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s2">&quot;DataRate&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">StringValue</span><span class="p">(</span><span class="s2">&quot;5Mbps&quot;</span><span class="p">))</span>
<span class="n">pointToPoint</span><span class="o">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s2">&quot;Delay&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">StringValue</span><span class="p">(</span><span class="s2">&quot;2ms&quot;</span><span class="p">))</span>

<span class="n">devices</span> <span class="o">=</span> <span class="n">pointToPoint</span><span class="o">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">internet</span><span class="o">.</span><span class="n">InternetStackHelper</span><span class="p">()</span>
<span class="n">stack</span><span class="o">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

<span class="n">address</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">internet</span><span class="o">.</span><span class="n">Ipv4AddressHelper</span><span class="p">()</span>
<span class="n">address</span><span class="o">.</span><span class="n">SetBase</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Ipv4Address</span><span class="p">(</span><span class="s2">&quot;10.1.1.0&quot;</span><span class="p">),</span> <span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Ipv4Mask</span><span class="p">(</span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">))</span>

<span class="n">interfaces</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="n">Assign</span> <span class="p">(</span><span class="n">devices</span><span class="p">);</span>

<span class="n">echoServer</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">UdpEchoServerHelper</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

<span class="n">serverApps</span> <span class="o">=</span> <span class="n">echoServer</span><span class="o">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">serverApps</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="n">serverApps</span><span class="o">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">10.0</span><span class="p">))</span>

<span class="n">echoClient</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">UdpEchoClientHelper</span><span class="p">(</span><span class="n">interfaces</span><span class="o">.</span><span class="n">GetAddress</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">echoClient</span><span class="o">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s2">&quot;MaxPackets&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">UintegerValue</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">echoClient</span><span class="o">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s2">&quot;Interval&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">TimeValue</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Seconds</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)))</span>
<span class="n">echoClient</span><span class="o">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s2">&quot;PacketSize&quot;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">UintegerValue</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>

<span class="n">clientApps</span> <span class="o">=</span> <span class="n">echoClient</span><span class="o">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">clientApps</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<span class="n">clientApps</span><span class="o">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">10.0</span><span class="p">))</span>

<span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Simulator</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
<span class="n">ns</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Simulator</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="running-python-scripts">
<h2>Running Python Scripts<a class="headerlink" href="#running-python-scripts" title="Permalink to this headline">¶</a></h2>
<p>waf contains some options that automatically update the python path to find the ns3 module.  To run example programs, there are two ways to use waf to take care of this.  One is to run a waf shell; e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf shell
$ python examples/wireless/mixed-wireless.py
</pre></div>
</div>
<p>and the other is to use the –pyrun option to waf:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf --pyrun examples/wireless/mixed-wireless.py
</pre></div>
</div>
<p>As of ns-3.30, a –pyrun-no-build option was added to allow the running of
a program without invoking a project rebuild.  This option may be useful
to improve execution time when running the same program repeatedly but with
different arguments, such as from scripts. It can be used in place of
–pyrun such as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf --pyrun-no-build examples/wireless/mixed-wireless.py
</pre></div>
</div>
<p>To run a python script under the C debugger:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf shell
$ gdb --args python examples/wireless/mixed-wireless.py
</pre></div>
</div>
<p>To run your own Python script that calls <em>ns-3</em> and that has this path, <code class="docutils literal notranslate"><span class="pre">/path/to/your/example/my-script.py</span></code>, do the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf shell
$ python /path/to/your/example/my-script.py
</pre></div>
</div>
</div>
<div class="section" id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h2>
<p>Python bindings for <em>ns-3</em> are a work in progress, and some limitations are known by developers.  Some of these limitations (not all) are listed here.</p>
<div class="section" id="incomplete-coverage">
<h3>Incomplete Coverage<a class="headerlink" href="#incomplete-coverage" title="Permalink to this headline">¶</a></h3>
<p>First of all, keep in mind that not 100% of the API is supported in Python.  Some of the reasons are:</p>
<ol class="arabic simple">
<li><p>some of the APIs involve pointers, which require knowledge of what kind of memory passing semantics (who owns what memory). Such knowledge is not part of the function signatures, and is either documented or sometimes not even documented.  Annotations are needed to bind those functions;</p></li>
<li><p>Sometimes a unusual fundamental data type or C++ construct is used which is not yet supported by PyBindGen;</p></li>
<li><p>GCC-XML does not report template based classes unless they are instantiated. (Note:  Need to confirm this limitation still exists with CastXML)</p></li>
</ol>
<p>Most of the missing APIs can be wrapped, given enough time, patience, and expertise, and will likely be wrapped if bug reports are submitted.  However, don’t file a bug report saying “bindings are incomplete”, because we do not have manpower to complete 100% of the bindings.</p>
</div>
<div class="section" id="conversion-constructors">
<h3>Conversion Constructors<a class="headerlink" href="#conversion-constructors" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://publib.boulder.ibm.com/infocenter/compbgpl/v9v111/topic/com.ibm.xlcpp9.bg.doc/language_ref/cplr384.htm">Conversion constructors</a> are not fully supported yet by PyBindGen, and they always act as explicit constructors when translating an API into Python.  For example, in C++ you can do this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Ipv4AddressHelper</span> <span class="n">ipAddrs</span><span class="p">;</span>
<span class="n">ipAddrs</span><span class="p">.</span><span class="n">SetBase</span> <span class="p">(</span><span class="s">&quot;192.168.0.0&quot;</span><span class="p">,</span> <span class="s">&quot;255.255.255.0&quot;</span><span class="p">);</span>
<span class="n">ipAddrs</span><span class="p">.</span><span class="n">Assign</span> <span class="p">(</span><span class="n">backboneDevices</span><span class="p">);</span>
</pre></div>
</div>
<p>In Python, for the time being you have to do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ipAddrs</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">internet</span><span class="o">.</span><span class="n">Ipv4AddressHelper</span><span class="p">()</span>
<span class="n">ipAddrs</span><span class="o">.</span><span class="n">SetBase</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Ipv4Address</span><span class="p">(</span><span class="s2">&quot;192.168.0.0&quot;</span><span class="p">),</span> <span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Ipv4Mask</span><span class="p">(</span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">))</span>
<span class="n">ipAddrs</span><span class="o">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">backboneDevices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="commandline">
<h3>CommandLine<a class="headerlink" href="#commandline" title="Permalink to this headline">¶</a></h3>
<p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">CommandLine::AddValue()</span></code> works differently in Python than it does in <em>ns-3</em>.  In Python, the first parameter is a string that represents the command-line option name.  When the option is set, an attribute with the same name as the option name is set on the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">CommandLine()</span></code> object.  Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NUM_NODES_SIDE_DEFAULT</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">cmd</span> <span class="o">=</span> <span class="n">ns3</span><span class="o">.</span><span class="n">CommandLine</span><span class="p">()</span>

<span class="n">cmd</span><span class="o">.</span><span class="n">NumNodesSide</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">cmd</span><span class="o">.</span><span class="n">AddValue</span><span class="p">(</span><span class="s2">&quot;NumNodesSide&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid side number of nodes (total number of nodes will be this number squared)&quot;</span><span class="p">)</span>

<span class="n">cmd</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>

<span class="p">[</span><span class="o">...</span><span class="p">]</span>

<span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">NumNodesSide</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">num_nodes_side</span> <span class="o">=</span> <span class="n">NUM_NODES_SIDE_DEFAULT</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">num_nodes_side</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">NumNodesSide</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tracing">
<h3>Tracing<a class="headerlink" href="#tracing" title="Permalink to this headline">¶</a></h3>
<p>Callback based tracing is not yet properly supported for Python, as new <em>ns-3</em> API needs to be provided for this to be supported.</p>
<p>Pcap file writing is supported via the normal API.</p>
<p>ASCII tracing is supported since <em>ns-3</em>.4 via the normal C++ API translated to Python.  However, ASCII tracing requires the creation of an ostream object to pass into the ASCII tracing methods.  In Python, the C++ std::ofstream has been minimally wrapped to allow this.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ascii</span> <span class="o">=</span> <span class="n">ns3</span><span class="o">.</span><span class="n">ofstream</span><span class="p">(</span><span class="s2">&quot;wifi-ap.tr&quot;</span><span class="p">)</span> <span class="c1"># create the file</span>
<span class="n">ns3</span><span class="o">.</span><span class="n">YansWifiPhyHelper</span><span class="o">.</span><span class="n">EnableAsciiAll</span><span class="p">(</span><span class="n">ascii</span><span class="p">)</span>
<span class="n">ns3</span><span class="o">.</span><span class="n">Simulator</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
<span class="n">ns3</span><span class="o">.</span><span class="n">Simulator</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
<span class="n">ascii</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># close the file</span>
</pre></div>
</div>
<p>There is one caveat: you must not allow the file object to be garbage collected while <em>ns-3</em> is still using it.  That means that the ‘ascii’ variable above must not be allowed to go out of scope or else the program will crash.</p>
</div>
</div>
<div class="section" id="working-with-python-bindings">
<h2>Working with Python Bindings<a class="headerlink" href="#working-with-python-bindings" title="Permalink to this headline">¶</a></h2>
<p>Python bindings are built on a module-by-module basis, and can be found in each module’s  <code class="docutils literal notranslate"><span class="pre">bindings</span></code> directory.</p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>The python bindings are generated into an ‘ns’ namespace.  Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ns.network</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ns.network</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Node</span><span class="p">()</span>
</pre></div>
</div>
<p>The best way to explore the bindings is to look at the various example
programs provided in <em>ns-3</em>; some C++ examples have a corresponding Python
example.  There is no structured documentation for the Python bindings
like there is Doxygen for the C++ API, but the Doxygen can be consulted
to understand how the C++ API works.</p>
</div>
<div class="section" id="python-bindings-workflow">
<h3>Python Bindings Workflow<a class="headerlink" href="#python-bindings-workflow" title="Permalink to this headline">¶</a></h3>
<p>The process by which Python bindings are handled is the following:</p>
<ol class="arabic simple">
<li><p>Periodically a developer uses a CastXML (<a class="reference external" href="https://github.com/CastXML/CastXML">https://github.com/CastXML/CastXML</a>) based API scanning script, which saves the scanned API definition as <code class="docutils literal notranslate"><span class="pre">bindings/python/ns3_module_*.py</span></code> files or as Python files in each modules’ <code class="docutils literal notranslate"><span class="pre">bindings</span></code> directory.  These files are kept under version control in the main <em>ns-3</em> repository;</p></li>
<li><p>Other developers clone the repository and use the already scanned API definitions;</p></li>
<li><p>When configuring <em>ns-3</em>, pybindgen will be automatically downloaded if not already installed.  Released <em>ns-3</em> tarballs will ship a copy of pybindgen.</p></li>
</ol>
<p>If something goes wrong with compiling Python bindings and you just want to ignore them and move on with C++, you can disable Python with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./waf configure --disable-python ...
</pre></div>
</div>
<p>To add support for modular bindings to an existing or new <em>ns-3</em> module, simply add the following line to its wscript build() function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bld</span><span class="o">.</span><span class="n">ns3_python_bindings</span><span class="p">()</span>
</pre></div>
</div>
<p>One must also provide the bindings files (usually by running the scanning
framework).</p>
</div>
<div class="section" id="regenerating-the-python-bindings">
<h3>Regenerating the Python bindings<a class="headerlink" href="#regenerating-the-python-bindings" title="Permalink to this headline">¶</a></h3>
<p><em>ns-3</em> will fail to successfully compile the Python bindings if the C++
headers are changed and no longer align with the stored Python bindings.
In this case, the developer has two main choices:  1) disable Python
as described above, or 2) update the bindings to align with the new C++
API.</p>
<div class="section" id="process-overview">
<h4>Process Overview<a class="headerlink" href="#process-overview" title="Permalink to this headline">¶</a></h4>
<p><em>ns-3</em> has an automated process to regenerate Python bindings from the C++
header files.  The process is only supported for Linux at the moment
(ns-3.29) because we are in the midst of transition to new tools.  The
current process is outlined below.  In short, the process currently
requires the following steps.</p>
<ol class="arabic simple">
<li><p>Prepare the system for scanning by installing the prerequisites,
including a development version of <code class="docutils literal notranslate"><span class="pre">clang</span></code>, the <code class="docutils literal notranslate"><span class="pre">CastXML</span></code> package,
and <code class="docutils literal notranslate"><span class="pre">pygccxml</span></code>.</p></li>
<li><p>Perform a scan of the module of interest or all modules</p></li>
</ol>
</div>
<div class="section" id="installing-a-clang-development-environment">
<h4>Installing a clang development environment<a class="headerlink" href="#installing-a-clang-development-environment" title="Permalink to this headline">¶</a></h4>
<p>Make sure you have a development version of the clang compiler installed
on your system.  This can take a long time to build from source.  Linux
distributions provide binary library packages such as <code class="docutils literal notranslate"><span class="pre">clang-dev</span></code> or
<code class="docutils literal notranslate"><span class="pre">clang-devel</span></code>.  The version should not be too important; version 3.8 is
known to work.  Note that there is a problem with the Ubuntu
package installation of <code class="docutils literal notranslate"><span class="pre">clang-dev</span></code>; see the Installation wiki page for
details on how to fix using some symlinks.</p>
</div>
<div class="section" id="installing-other-prerequisites">
<h4>Installing other prerequisites<a class="headerlink" href="#installing-other-prerequisites" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">cxxfilt</span></code> is a new requirement, typically installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>; e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo pip install cxxfilt
</pre></div>
</div>
<p>See also the wiki for installation notes for your system.</p>
</div>
<div class="section" id="set-up-a-bake-build-environment">
<h4>Set up a <code class="docutils literal notranslate"><span class="pre">bake</span></code> build environment<a class="headerlink" href="#set-up-a-bake-build-environment" title="Permalink to this headline">¶</a></h4>
<p>Try the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> bake
$ <span class="nb">export</span> <span class="nv">BAKE_HOME</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
$ <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$BAKE_HOME</span>/build/bin
$ <span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="nv">$BAKE_HOME</span>/build/lib
$ <span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:<span class="nv">$BAKE_HOME</span>/build/lib
$ mkdir -p build/lib
</pre></div>
</div>
</div>
<div class="section" id="configure">
<h4>Configure<a class="headerlink" href="#configure" title="Permalink to this headline">¶</a></h4>
<p>Perform a configuration at the bake level:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./bake.py configure -e ns-3-dev -e pygccxml-1.9.1
</pre></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">bake</span> <span class="pre">show</span></code> should show something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./bake.py show
</pre></div>
</div>
<p>Should say:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-- System Dependencies --
 &gt; clang-dev - OK
 &gt; g++ - OK
 &gt; libxml2-dev - OK
 &gt; pygoocanvas - OK
 &gt; pygraphviz - OK
 &gt; python-dev - OK
 &gt; qt - OK
 &gt; setuptools - OK
</pre></div>
</div>
</div>
<div class="section" id="download">
<h4>Download<a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h4>
<p>Try the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./bake.py download
 &gt;&gt; Searching <span class="k">for</span> system dependency python-dev - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency clang-dev - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency g++ - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency setuptools - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency pygoocanvas - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency pygraphviz - OK
 &gt;&gt; Searching <span class="k">for</span> system dependency qt - OK
 &gt;&gt; Downloading castxml - OK
 &gt;&gt; Downloading netanim - OK
 &gt;&gt; Downloading pygccxml-1.9.1 - OK
 &gt;&gt; Downloading pygccxml - OK
 &gt;&gt; Downloading pybindgen - OK
 &gt;&gt; Downloading ns-3-dev - OK
</pre></div>
</div>
</div>
<div class="section" id="build">
<h4>Build<a class="headerlink" href="#build" title="Permalink to this headline">¶</a></h4>
<p>Try the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mkdir -p build/lib
$ ./bake.py build
</pre></div>
</div>
<p>It should fail on the <em>ns-3</em> bindings complilation.</p>
<p>The output of ‘./waf configure’ can be inspected to see if Python API scanning
support is enabled:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Python API Scanning Support   : enabled
</pre></div>
</div>
<p>It may say something like this, if the support is not active:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Python API Scanning Support   : not enabled (Missing &#39;pygccxml&#39; Python module)
</pre></div>
</div>
<p>In this case, the user must take steps to install castxml and pygccxml;
castxml binary must be in the shell’s path, and pygccxml must be in the
Python path.</p>
</div>
<div class="section" id="lp64-vs-ilp32-bindings">
<h4>LP64 vs ILP32 bindings<a class="headerlink" href="#lp64-vs-ilp32-bindings" title="Permalink to this headline">¶</a></h4>
<p>Linux (64-bit, as most modern installations use) and MacOS use different
data models, as explained here:  <a class="reference external" href="https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.cbcpx01/datatypesize64.htm">https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.cbcpx01/datatypesize64.htm</a></p>
<p>Linux uses the LP64 model, and MacOS (as well as 32-bit Linux) use the ILP32
model.  Users will note that there are two versions of bindings files in
each ns-3 module directory; one with an ILP32.py suffix and one with
an LP64.py suffix.  Only one is used on any given platform.  The main
difference is in the representation of the 64 bit integer type as either
a ‘long’ (LP64) or ‘long long’ (ILP32).</p>
<p>The process (only supported on Linux at present) generates the LP64
bindings using the toolchain and then copies the LP64 bindings to the
ILP32 bindings with some type subsitutions automated by Waf scripts.</p>
</div>
<div class="section" id="rescanning-a-module">
<h4>Rescanning a module<a class="headerlink" href="#rescanning-a-module" title="Permalink to this headline">¶</a></h4>
<p>To re-scan a module:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> source/ns-3-dev
$ ./waf --apiscan<span class="o">=</span>wifi
</pre></div>
</div>
<p>To re-scan all modules:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> source/ns-3-dev
$ ./waf --apiscan<span class="o">=</span>all
</pre></div>
</div>
</div>
<div class="section" id="generating-bindings-on-macos">
<h4>Generating bindings on MacOS<a class="headerlink" href="#generating-bindings-on-macos" title="Permalink to this headline">¶</a></h4>
<p>In principle, this should work (and should generate the 32-bit bindings).
However, maintainers have not been able to complete this port as of ns-3.29.
We would welcome suggestions on how to enable scanning for MacOS.</p>
</div>
</div>
<div class="section" id="organization-of-the-modular-python-bindings">
<h3>Organization of the Modular Python Bindings<a class="headerlink" href="#organization-of-the-modular-python-bindings" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">src/&lt;module&gt;/bindings</span></code> directory may contain the following files, some of them optional:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">callbacks_list.py</span></code>: this is a scanned file, DO NOT TOUCH.  Contains a list of Callback&lt;…&gt; template instances found in the scanned headers;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modulegen__gcc_LP64.py</span></code>: this is a scanned file, DO NOT TOUCH.  Scanned API definitions for the GCC, LP64 architecture (64-bit)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modulegen__gcc_ILP32.py</span></code>: this is a scanned file, DO NOT TOUCH.  Scanned API definitions for the GCC, ILP32 architecture (32-bit)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modulegen_customizations.py</span></code>: you may optionally add this file in order to customize the pybindgen code generation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scan-header.h</span></code>: you may optionally add this file to customize what header file is scanned for the module.  Basically this file is scanned instead of ns3/&lt;module&gt;-module.h.  Typically, the first statement is #include “ns3/&lt;module&gt;-module.h”, plus some other stuff to force template instantiations;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module_helpers.cc</span></code>: you may add additional files, such as this, to be linked to python extension module, but they have to be registered in the wscript. Look at src/core/wscript for an example of how to do so;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;module&gt;.py</span></code>: if this file exists, it becomes the “frontend” python module for the ns3 module, and the extension module (.so file) becomes _&lt;module&gt;.so instead of &lt;module&gt;.so.  The &lt;module&gt;.py file has to import all symbols from the module _&lt;module&gt; (this is more tricky than it sounds, see src/core/bindings/core.py for an example), and then can add some additional pure-python definitions.</p></li>
</ul>
</div>
</div>
<div class="section" id="more-information-for-developers">
<h2>More Information for Developers<a class="headerlink" href="#more-information-for-developers" title="Permalink to this headline">¶</a></h2>
<p>If you are a developer and need more information on <em>ns-3</em>’s Python bindings, please see the <a class="reference external" href="http://www.nsnam.org/wiki/NS-3_Python_Bindings">Python Bindings wiki page</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Python to Run <em>ns-3</em></a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#an-example-python-script-that-runs-ns3">An Example Python Script that Runs <em>ns-3</em></a></li>
<li><a class="reference internal" href="#running-python-scripts">Running Python Scripts</a></li>
<li><a class="reference internal" href="#caveats">Caveats</a><ul>
<li><a class="reference internal" href="#incomplete-coverage">Incomplete Coverage</a></li>
<li><a class="reference internal" href="#conversion-constructors">Conversion Constructors</a></li>
<li><a class="reference internal" href="#commandline">CommandLine</a></li>
<li><a class="reference internal" href="#tracing">Tracing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-python-bindings">Working with Python Bindings</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#python-bindings-workflow">Python Bindings Workflow</a></li>
<li><a class="reference internal" href="#regenerating-the-python-bindings">Regenerating the Python bindings</a><ul>
<li><a class="reference internal" href="#process-overview">Process Overview</a></li>
<li><a class="reference internal" href="#installing-a-clang-development-environment">Installing a clang development environment</a></li>
<li><a class="reference internal" href="#installing-other-prerequisites">Installing other prerequisites</a></li>
<li><a class="reference internal" href="#set-up-a-bake-build-environment">Set up a <code class="docutils literal notranslate"><span class="pre">bake</span></code> build environment</a></li>
<li><a class="reference internal" href="#configure">Configure</a></li>
<li><a class="reference internal" href="#download">Download</a></li>
<li><a class="reference internal" href="#build">Build</a></li>
<li><a class="reference internal" href="#lp64-vs-ilp32-bindings">LP64 vs ILP32 bindings</a></li>
<li><a class="reference internal" href="#rescanning-a-module">Rescanning a module</a></li>
<li><a class="reference internal" href="#generating-bindings-on-macos">Generating bindings on MacOS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#organization-of-the-modular-python-bindings">Organization of the Modular Python Bindings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#more-information-for-developers">More Information for Developers</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="gnuplot.html"
                        title="previous chapter">Making Plots using the Gnuplot Class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tests.html"
                        title="next chapter">Tests</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/python.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tests.html" title="Tests"
             >next</a> |</li>
        <li class="right" >
          <a href="gnuplot.html" title="Making Plots using the Gnuplot Class"
             >previous</a> |</li>
    <li class="navelem"><a href="">ns-3</a><span class="navelem">&nbsp;</span></li>
    
        <li class="nav-item nav-item-0"><a href="index.html">Manual</a><span class="navelem">&nbsp;</span></li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2006-2019.
      Last updated on Apr 29, 2020 18:24.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.
    </div>
  </body>
</html>