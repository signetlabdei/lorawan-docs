<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<title>ns-3: Packet Performance</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ns3_stylesheet.css" rel="stylesheet" type="text/css"/>
    <link href="favicon.ico" rel="shortcut icon" type="image/ico"></link>
    <script type="text/javascript" src="drop-down-menu.js"></script>
    <script type="text/javascript" src="ns3_version.js"></script>
    <script type="text/javascript" src="ns3_links.js"></script>
  </head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
	<table cellspacing="0" cellpadding="0" width="100%">
	  <tbody>
	    <tr style="height: 56px;">
	      <td id="projectlogo">
		<a id="ns3_home1"
		  href="http://www.nsnam.org/">
		  <img alt="ns-3 Logo"
		    src="ns-3-inverted-notext-small.png"/>
		</a>
	      </td>
	      <td id="projecttext">
		<div id="projectbrief">A Discrete-Event Network Simulator</div>
		<span id="projectnumber"><script type="text/javascript">document.write(ns3_version)</script></span>
	      </td>
	      <td id="ns3-menu">
		<div class="menu">
		  <ul >
		    <li><a id="ns3_home2"
			href="http://www.nsnam.org/"
			>&nbsp;&nbsp;Home</a>
		    </li>
		    <li><span
			onmouseover="mopen('mTuts')" 
			onmouseout="mclosetime()"
			>Tutorials &nbsp;&#x25BC;</span>
		      <div id="mTuts" 
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_tut"
			  href="/docs/tutorial/html/index.html"
			  >English</a><br/>
		    </li>
		    <li><span
			onmouseover="mopen('mDocs')" 
			onmouseout="mclosetime()"
			>Docs &nbsp;&nbsp;&nbsp;&#x25BC;</span>
		      <div id="mDocs"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_wiki"
			  href="http://www.nsnam.org/wiki"
			  >Wiki</a><br/>
			<a id="ns3_man"
			    href="/docs/manual/html/index.html"
			    >Manual</a><br/>
			<a id="ns3_mod"
			   href="/docs/models/html/index.html"
			   >Models</a><br/>
		    </li>
		    <li><span
			onmouseover="mopen('mDev')" 
			onmouseout="mclosetime()"
			>Develop &#x25BC;</span>
		      <div id="mDev"
		        onmouseover="mcancelclosetime()" 
		        onmouseout="mclosetime()">
			<a id="ns3_api"
			   href="/docs/doxygen/index.html"
			   >API</a><br/>
			<a id="ns3_bugs"
			   href="http://www.nsnam.org/bugzilla/">Bugs</a>
		    </li>
		  </ul>
		</div>
	      </td>
	      <td id="projectsection">
		<span style="margin-right:10px">API</span>
	      </td>
	    </tr>
	  </tbody>
	</table>
	<script  type="text/javascript">ns3_write_links();</script>
      </div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__packetperf.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Packet Performance<div class="ingroups"><a class="el" href="group__network.html">Network</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The current implementation of the byte buffers and tag list is based on COW (Copy On Write. An introduction to COW can be found in Scott Meyer's "More Effective C++", items 17 and 29). What this means is that copying packets without modifying them is very cheap (in terms of cpu and memory usage) and modifying them can be also very cheap. What is key for proper COW implementations is being able to detect when a given modification of the state of a packet triggers a full copy of the data prior to the modification: COW systems need to detect when an operation is "dirty".  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Packet Performance:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__packetperf.png" border="0" usemap="#group____packetperf" alt=""/></div>
<map name="group____packetperf" id="group____packetperf">
<area shape="rect" href="group__network.html" title="This section documents the API of the ns&#45;3 network module. For a generic functional description,..." alt="" coords="5,5,83,31"/>
<area shape="rect" title="The current implementation of the byte buffers and tag list is based on COW (Copy On Write...." alt="" coords="131,5,283,31"/>
</map>
</div>
<p>The current implementation of the byte buffers and tag list is based on COW (Copy On Write. An introduction to COW can be found in Scott Meyer's "More Effective C++", items 17 and 29). What this means is that copying packets without modifying them is very cheap (in terms of cpu and memory usage) and modifying them can be also very cheap. What is key for proper COW implementations is being able to detect when a given modification of the state of a packet triggers a full copy of the data prior to the modification: COW systems need to detect when an operation is "dirty". </p>
<p>Dirty operations:</p><ul>
<li><a class="el" href="classns3_1_1_packet.html#a465108c595a0bc592095cbcab1832ed8" title="Add header to this packet.">ns3::Packet::AddHeader</a></li>
<li><a class="el" href="classns3_1_1_packet.html#ae26b490c30ae5bc98be5181ec6e06db8" title="Add trailer to this packet.">ns3::Packet::AddTrailer</a></li>
<li>both versions of <a class="el" href="classns3_1_1_packet.html#a14ec3d4250b425468764de58f5837b6b" title="Concatenate the input packet at the end of the current packet.">ns3::Packet::AddAtEnd</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a078fe922d976a417ab25ba2f3c2fd667" title="Remove a packet tag.">ns3::Packet::RemovePacketTag</a></li>
<li><a class="el" href="classns3_1_1_packet.html#afb014ae9f4adddbfc51c64b085bfd405" title="Replace the value of a packet tag.">ns3::Packet::ReplacePacketTag</a></li>
</ul>
<p>Non-dirty operations:</p><ul>
<li><a class="el" href="classns3_1_1_packet.html#ac4a6bcd77e58bdc14c42a7d572d66cc9" title="Add a packet tag.">ns3::Packet::AddPacketTag</a></li>
<li><a class="el" href="classns3_1_1_packet.html#aec5a71b498e6cd5816de9f5e9b36c397" title="Search a matching tag and call Tag::Deserialize if it is found.">ns3::Packet::PeekPacketTag</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a6c7bc5d1067c1d7fbd0fd70289182e8b" title="Remove all packet tags.">ns3::Packet::RemoveAllPacketTags</a></li>
<li><a class="el" href="classns3_1_1_packet.html#ad62c58f829e211a1604d203b871098af" title="Tag each byte included in this packet with a new byte tag.">ns3::Packet::AddByteTag</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a97561e433646891407aae64e750c8c0f" title="Finds the first tag matching the parameter Tag type.">ns3::Packet::FindFirstMatchingByteTag</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a083f54c9db31aeff30551a9e20fcda42" title="Remove all byte tags stored in this packet.">ns3::Packet::RemoveAllByteTags</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a0961eccf975d75f902d40956c93ba63e" title="Deserialize and remove the header from the internal buffer.">ns3::Packet::RemoveHeader</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a2155e042083e9a17ad3b33f9fecb4be4" title="Remove a deserialized trailer from the internal buffer.">ns3::Packet::RemoveTrailer</a></li>
<li><a class="el" href="classns3_1_1_packet.html#acdb23fec2c1dbebd9e6917895e9bcc65" title="Create a new packet which contains a fragment of the original packet.">ns3::Packet::CreateFragment</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a78aa207e7921dd2f9f7e0d0b7a1c730a" title="Remove size bytes from the start of the current packet.">ns3::Packet::RemoveAtStart</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a607de6c1abda2a960e99a3b59fd35d14" title="Remove size bytes from the end of the current packet.">ns3::Packet::RemoveAtEnd</a></li>
<li><a class="el" href="classns3_1_1_packet.html#a5bafd70ccf970b10524e2d61afd39dc1" title="Copy the packet contents to a byte buffer.">ns3::Packet::CopyData</a></li>
</ul>
<p>Dirty operations will always be slower than non-dirty operations, sometimes by several orders of magnitude. However, even the dirty operations have been optimized for common use-cases which means that most of the time, these operations will not trigger data copies and will thus be still very fast. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Apr 29 2020 17:43:20 for ns-3 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
